/*! Things v0.0.4 | (c) Hatio, Lab. | MIT License */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("_")):"function"==typeof define&&define.amd?define(["_"],e):"object"==typeof exports?exports.things=e(require("_")):t.things=e(t._)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r,i;r=[n(1),n(7),n(8),n(2),n(3),n(4),n(5),n(6),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29)],i=function(t,e,n,r,i,o,s,a,c,u,p,h,l,f,d,g,y,_,v,m,x,b,w,A,k,E,M,S,P){"use strict";var R;return R=[],{create:function(e){var n;return n=new t(e).getStage(),R.push(n),n},destroy:function(t){var e;return e=R.indexOf(t),e>-1&&R.splice(e,1),t.dispose()},stages:function(){return R},Component:e,Container:n,Animation:a,shape:{Barcode:c,Circle:u,Ellipse:p,ImageBox:h,Path:l,Rect:f,Ruler:d,Shape:s,Text:g,Line:y},layer:{DebugLayer:_,Layer:i,MagnifyLayer:v,RulerLayer:m,SelectionLayer:x,SlideLayer:b,WidgetLayer:w},group:{Group:o},handle:{BoundHandle:A,CircleHandle:k,Handle:E,P2PHandle:M,PathHandle:S,RotationHandle:P},stage:{Stage:r}}}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(39),n(30),n(2),n(7),n(31),n(32),n(33),n(34),n(35),n(40),n(41)],i=function(t,e,n,r,i,o,s,a,c,u,p){"use strict";var h;return r.include({setController:function(t){return this.controller=t},getController:function(){return this.controller},getStage:function(){return this.controller.getStage()},setSpec:function(t){return this.spec=t},getSpec:function(){return this.spec},build:function(t,e){return this.controller.build(t,e||this)},require:function(t){if(!this.controller)throw new Error("controller not initialized");return this.controller.require(t)},select:function(t,e){if(!this.controller)throw new Error("controller not initialized");return this.controller.select(t,e)},debug:function(t,e){return this.require("debug-layer").debug(t,e)}}),h=function(){function e(e){this.options=t.clone(e),this.exports={},this.exportsManager=new c(this),this.commandManager=new u,this.componentRegistry=new i,this.componentRegistry.setRegisterCallback(function(t){return this.exportsManager["import"](t.type,t.exports)},this),this.componentRegistry.setUnregisterCallback(function(t){return this.exportsManager.remove(t.type)},this),this.eventEngine=new a,this.componentFactory=new s(this.componentRegistry,this),this.componentRegistry.register("stage",n),this.stage=this.componentFactory.create("stage",e),this.eventEngine.setRoot(this.stage),this.eventEngine.add(this,p,this)}return e.prototype.setStage=function(t){return this.stage=t},e.prototype.getStage=function(){return this.stage},e.prototype.build=function(t,e){return this.componentFactory.build(t,e)},e.prototype.select=function(t,e){return o.select(t,e||this.stage)},e.prototype["import"]=function(t,e,n){return this.exportsManager["import"](t,e,n)},e.prototype.require=function(t){return this.exportsManager.require(t)},e.prototype.register=function(t,e){return this.componentRegistry.register(t,e)},e.prototype.apply=function(t){var e,n,r,i,o;o=[];for(r in t)i=t[r],n=this.select(r),o.push(function(){var t,r,o;for(o=[],t=0,r=n.length;r>t;t++)e=n[t],o.push(e.set(i));return o}());return o},e.prototype.dispose=function(){return this.componentFactory.dispose(),this.commandManager.dispose(),this.eventEngine.dispose(),this.componentRegistry.dispose(),this.exportsManager.dispose()},e}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(30),n(8),n(43),n(44),n(36),n(37)],i=function(t,e,n,r,i,o){"use strict";var a;return a=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return s(a,e),a.prototype.draw=function(){return this.forEach(function(t){return t.draw})},a.prototype.init=function(){var e,n,r;return e=this.get("container"),console.log("container",e,this.config()),this.client_container=e instanceof HTMLElement?e:document.getElementById(e),this.client_container.innerHTML="",this.html_container=document.createElement("div"),this.html_container.style.position="relative",this.html_container.style.display="inline-block",r=this.config("w"),n=this.config("h"),this.html_container.style.width=void 0===r||null===r?"100%":r+"px",this.html_container.style.height=void 0===n||null===n?"100%":n+"px",this.client_container.appendChild(this.html_container),t.mobile||(this.mouseEventEngine=new i(this)),this.touchEventEngine=new o(this)},a.prototype.dispose=function(){return this.client_container.removeChild(this.html_container),this.controller.dispose(),this.touchEventEngine.dispose(),this.mouseEventEngine?this.mouseEventEngine.dispose():void 0},a.prototype.capture=function(t){var e,n,r,i,o;if(this.size()>0)for(r=i=o=this.size()-1;0>=o?0>=i:i>=0;r=0>=o?++i:--i)if(n=this.getAt(r),e=n.capture(t))return e;return this},a.prototype.position=function(){return this.html_container.getBoundingClientRect?this.html_container.getBoundingClientRect():{top:0,left:0}},a.prototype.point=function(e){var n,r,i,o,s,a;return e?(i=this.position(),s=null,a=null,void 0!==e.touches?e.touches.length>0&&(o=e.touches[0],s=o.clientX-i.left,a=o.clientY-i.top):(n=0,r=0,"CANVAS"===e.target.tagName&&(n=e.target.offsetLeft,r=e.target.offsetTop),void 0!==e.offsetX?(s=e.offsetX+n,a=e.offsetY+r):"mozilla"===t.UA.browser?(s=e.layerX+n,a=e.layerY+r):void 0!==e.clientX&&i&&(s=e.clientX-i.left+n,a=e.clientY-i.top+r)),null!==s&&null!==a&&(this.point_pos={x:s,y:a}),this.point_pos):this.point_pos},a.prototype.register=function(t,e){return this.controller.register(t,e)},a.prototype.model=function(t){var e,n,r;if(t.dependencies){r=t.dependencies;for(n in r)e=r[n],this.register(n,e)}return this.forEach(function(e){return e.model?e.model(t):void 0})},a.prototype.apply=function(t){return this.controller.apply(t)},a.prototype.objectify=function(){var t,e;return t=[],this.forEach(function(e){return t.push(e.objectify())}),e={},this.controller.componentRegistry.forEach(function(t,n){return e[t]=n.spec.source},this),{dependencies:e,components:t,config:_.omit(this.config(),"container")}},a.spec={type:"stage",source:"core:stage.Stage",containable:!0,container_type:"stage",description:"Stage",dependencies:{},properties:[n,r,{alpha:{type:"number","default":100},container:{type:"string"}}]},a}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(6),n(8),n(42),n(43),n(44),n(45)],i=function(t,e,n,r,i,o){"use strict";var a,c,u,p;return p=[],c=new t(function(){var t,e;if(0===p.length)return c.stop();for(e=[];t=p.shift();)e.push(t._draw());return e}),u=function(t){return-1<p.indexOf(t)?void 0:(p.push(t),1===p.length?c.start():void 0)},a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.clearCanvas=function(){return this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype._draw=function(){var t,e,n;return t=this.canvas.getContext("2d"),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.save(),e=this.get("offset-x"),n=this.get("offset-y"),t.translate(e,n),this.forEach(function(e){return e.draw(t)}),t.restore()},e.prototype.draw=function(){return u(this)},e.prototype.shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},e.prototype.capture=function(t){var e,n,r,i,o,s,a;if(r=this.canvas.getContext("2d"),r.beginPath(),o={x:t.x-this.get("offset-x")-this.get("x"),y:t.y-this.get("offset-y")-this.get("y")},this.shape(r),this.size()>0)for(i=s=a=this.size()-1;0>=a?0>=s:s>=0;i=0>=a?++s:--s)if(n=this.getAt(i),e=n.capture(o,r))return e;return null},e.prototype.init=function(){var t,e,n,r,i;return this.html_container=this.controller.getStage().html_container,this.canvas=document.createElement("canvas"),t=this.controller.options,r=this.get("x")||0,i=this.get("y")||0,n=this.get("w")||t.w&&t.w-r||this.html_container.offsetWidth-r,e=this.get("h")||t.h&&t.h-i||this.html_container.offsetHeight-i,this.set({x:r,y:i,w:n,h:e}),this.canvas.style.display=this.get("visible")!==!1?"block":"none",this.canvas.style.padding=0,this.canvas.style.margin=0,this.canvas.style.border=0,this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.canvas.style.top=i+"px",this.canvas.style.left=r+"px",this.canvas.setAttribute("width",n),this.canvas.setAttribute("height",e),this.html_container.appendChild(this.canvas)},e.prototype.event_map=function(){return n},e.prototype.dispose=function(){return this.html_container.removeChild(this.canvas),this.controller=null},e.spec={type:"layer",source:"core:layer.Layer",containable:!0,container_type:"layer",description:"Abstract Layer",dependencies:{},properties:[r,i,o,{alpha:{type:"number","default":100},"offset-x":{type:"number","default":0},"offset-y":{type:"number","default":0},resizable:{type:"boolean"}}]},e}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(8),n(46),n(47),n(43),n(44),n(45)],i=function(t,e,n,r,i,o){"use strict";var a;return a=function(t){function a(){return a.__super__.constructor.apply(this,arguments)}return s(a,t),a.include(e),a.include(n),a.prototype.handles=function(){return["bound-handle","rotation-handle"]},a.prototype.positions=function(){return[["x","y"]]},a.prototype.bound=function(){return{x:this.get("x"),y:this.get("y"),w:this.get("w"),h:this.get("h")}},a.prototype.move=function(t,e){var n,r,i,o,s,a,c,u,p;if(r=t.delta,!_.isEmpty(r)){for(s={},o=this.positions(),a=0,u=o.length;u>a;a++)i=o[a],r.x&&(s[i[0]]=Math.round(this.get(i[0])+r.x)),r.y&&(s[i[1]]=Math.round(this.get(i[1])+r.y));if(this.set(s),e){for(n={},c=0,p=o.length;p>c;c++)i=o[c],n[i[0]]=this.get(i[0]),n[i[1]]=this.get(i[1]);return this.configure(n),console.log(this.type,this.config())}}},a.prototype.event_map=null,a.spec={type:"group",source:"core:group.Group",containable:!0,container_type:"group",description:"Group",dependencies:{},properties:[r,i,o,{clip:{type:"boolean","default":!0}}]},a}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(7),n(46),n(48),n(49),n(43),n(45)],i=function(t,e,n,r,i,o,a){"use strict";var c;return c=function(e){function c(){return c.__super__.constructor.apply(this,arguments)}return s(c,e),c.include(n),c.include(r),c.include(i),c.prototype.handles=function(){var t;return t=["rotation-handle"],this.get("resizable")&&t.push("bound-handle"),t},c.prototype.positions=function(){return[["x","y"]]},c.prototype.move=function(e,n){var r,i,o,s,a,c,u,p,h,l,f,d,g,y;if(i=e.delta,!t.isEmpty(i)){if(c={},a=this.positions(),a instanceof Array)for(u=0,f=a.length;f>u;u++)o=a[u],i.x&&(c[o[0]]=Math.round(this.get(o[0])+i.x)),i.y&&(c[o[1]]=Math.round(this.get(o[1])+i.y));else{for(s=t.clone(this.get(a)),p=0,d=s.length;d>p;p++)o=s[p],i.x&&(o[0]+=Math.round(i.x)),i.y&&(o[1]+=Math.round(i.y));c[a]=s}if(this.set(c),n){if(r={},a instanceof Array){for(h=0,g=a.length;g>h;h++)o=a[h],r[o[0]]=this.get(o[0]),r[o[1]]=this.get(o[1]);return this.configure(r)}for(l=0,y=s.length;y>l;l++)o=s[l],r[o[0]]=this.get(o[0]),r[o[1]]=this.get(o[1]);return this.configure(a,s)}}},c.prototype.event_map=function(){return null},c.spec={type:"shape",source:"core:shape.Shape",containable:!1,description:"Abstract Shape",dependencies:{},properties:[o,a]},c}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n,r,i,o,s,a,c,u,p,h;return s=[],r=0,i=!1,n=function(t){return s.push(t),a()},u=function(t){var e,n,r,i,o,a;for(n=t.id,a=[],r=i=0,o=s.length;o>i;r=++i){if(e=s[r],e.id===n){s.splice(r,1);break}a.push(void 0)}return a},c=function(){return window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return(new Date).getTime()}}(),e=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)}}(),p=function(){return e.apply(window,arguments)},h=function(){var t,e,n,r,i;for(i=[],n=0,r=s.length;r>n;n++)t=s[n],e=t.func,t.updateFrameObject(c()),i.push(e?e.call(t,t.frame):void 0);return i},o=function(){return s.length?(p(o),h()):i=!1},a=function(){return i?void 0:(i=!0,o())},t=function(){function t(t){this.func=t,this.id=r++,this.frame={time:0,timeDiff:0,lastTime:c()}}return t.prototype.isRunning=function(){var t,e,n;for(e=0,n=s.length;n>e;e++)if(t=s[e],t.id===this.id)return!0;return!1},t.prototype.start=function(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=c(),n(this)},t.prototype.stop=function(){return u(this)},t.prototype.updateFrameObject=function(t){return this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff},t}()}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(38),n(50),n(51),n(52),n(48)],i=function(t,e,n,r,i){"use strict";var o;return o=function(t){function o(t,e){this.type=t,this.container=e}return s(o,t),o.include(e),o.include(n),o.include(r),o.include(i),o.prototype.getType=function(){return this.type},o.prototype.dispose=function(){return this.setContainer(null)},o.prototype.getContainer=function(){return this.container},o.prototype.setContainer=function(t){return t!==this.container?(this.container&&this.container.remove(this),this.container=t,this.container?this.container.add(this):void 0):void 0},o.prototype.moveAt=function(t){return this.getContainer()?this.container.moveChildAt(t,this):void 0},o.prototype.moveForward=function(){return this.getContainer()?this.container.moveChildForward(this):void 0},o.prototype.moveBackward=function(){return this.getContainer()?this.container.moveChildBackward(this):void 0},o.prototype.moveToFront=function(){return this.getContainer()?this.container.moveChildToFront(this):void 0},o.prototype.moveToBack=function(){return this.getContainer()?this.container.moveChildToBack(this):void 0},o}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(7),n(53)],i=function(t,e,n){"use strict";var r,i,o,a,c,u,p,h,l,f,d,g,y,_,v,m;return i=[],a=function(t,r){var i,o,s;if(i=r instanceof e,i&&(s=r.getContainer())){if(t===s)return;v(t,r)}return o=t.__components__.push(r)-1,i&&r.setContainer(t),n.add(t,t,r,o),i?(r.delegate_on(t),n.added(r,t,r,o)):void 0},v=function(t,r){var i,o;return i=r instanceof e,o=t.__components__.indexOf(r),-1!==o&&(o>-1&&t.__components__.splice(o,1),i&&r.setContainer(null),n.remove(t,t,r),r instanceof e)?(n.removed(r,t,r),r.delegate_off(t)):void 0},o=function(t){var e,n,r;if(this.__components__||(this.__components__=[]),!(t instanceof Array))return o.call(this,[t]);for(n=0,r=t.length;r>n;n++)e=t[n],a(this,e);return this},y=function(t){var e,n,r;if(!(t instanceof Array))return y.call(this,[t]);if(this.__components__){for(n=0,r=t.length;r>n;n++)e=t[n],v(this,e);return this}},_=function(){return this.remove(t.clone(this.__components__))},u=function(t){return this.__components__?this.__components__[t]:void 0},c=function(t,e){return this.__components__?this.__components__.forEach(t,e):void 0},p=function(t){return(this.__components__||i).indexOf(t)},m=function(){return(this.__components__||i).length},h=function(t,e){var n,r,i;return r=this.indexOf(e),-1!==r?(n=this.__components__.splice(0,r),i=this.__components__.splice(1),this.__components__=n.concat(i),t=Math.max(0,t),t=Math.min(t,this.__components__.length),n=this.__components__.splice(0,t),this.__components__=n.concat(e,this.__components__)):void 0},f=function(t){var e;return e=this.indexOf(t),-1!==e&&e!==this.size()-1?(this.__components__[e]=this.__components__[e+1],this.__components__[e+1]=t):void 0},l=function(t){var e;return e=this.indexOf(t),-1!==e&&0!==e?(this.__components__[e]=this.__components__[e-1],this.__components__[e-1]=t):void 0},g=function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&n!==this.size()-1?(e=this.__components__.splice(0,n),r=this.__components__.splice(1),this.__components__=e.concat(r,this.__components__)):void 0},d=function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&0!==n?(e=this.__components__.splice(0,n),r=this.__components__.splice(1),this.__components__=this.__components__.concat(e,r)):void 0},r=function(e){function n(t){n.__super__.constructor.call(this,t)}return s(n,e),n.prototype.dispose=function(){var e,r,i,o;if(this.__components__){for(e=t.clone(this.__components__),i=0,o=e.length;o>i;i++)r=e[i],r.dispose();this.__components__=null}return n.__super__.dispose.call(this)},n.prototype.add=o,n.prototype.remove=y,n.prototype.removeAll=_,n.prototype.size=m,n.prototype.getAt=u,n.prototype.indexOf=p,n.prototype.forEach=c,n.prototype.moveChildAt=h,n.prototype.moveChildForward=f,n.prototype.moveChildBackward=l,n.prototype.moveChildToFront=g,n.prototype.moveChildToBack=d,n}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(12),n(24),n(29),n(44)],i=function(t,e,n,r,i,o){"use strict";var a;return a=function(n){function a(){return a.__super__.constructor.apply(this,arguments)}return s(a,n),a.prototype.onadded=function(t){return this.set("src",this.makeurl()),a.__super__.onadded.call(this,t)},a.prototype.makeurl=function(){var t;return t="http://barcode.hatiolab.com:81/?",t+="text="+window.escape(this.get("text")),t+="&bcid="+(this.get("symbol")||"code128"),t+="&wscale="+(this.get("scale-w")||2),t+="&hscale="+(this.get("scale-h")||2),t+="&rotate="+(this.get("rotation")||"N"),this.get("alttext")?t+="&alttext="+window.escape(this.get("alttext")):this.get("includetext")&&(t+="&alttext="+window.escape(this.get("text"))),this.get("barcolor")&&"#000000"!==this.get("barcolor")&&(t+="&barcolor="+window.escape(this.get("barcolor"))),this.get("backgroundcolor")&&"#FFFFFF"!==this.get("backgroundcolor")&&(t+="&backgroundcolor="+window.escape(this.get("backgroundcolor"))),t},a.prototype.event_map=function(){var e;return e={"(self)":{"(self)":{change:function(e,n,r){var i;return i=t.pick(r,["symbol","text","alttext","scale-h","scale-w","rotation","includetext","barcolor","backgroundcolor"]),t.isEmpty(i)?void 0:(this.silentSet("src",this.makeurl()),this.image.src=this.get("src"))}}}}},a.spec={type:"barcode",source:"core:shape.Barcode",containable:!1,description:"Barcode",dependencies:{"bound-handle":r,"rotation-handle":i},properties:[e.spec.properties,o,{symbol:{type:"string"},text:{type:"string"},alttext:{type:"string"},"scale-h":{type:"number"},"scale-w":{type:"number"},rotation:{type:"sring"},includetext:{type:"boolean"},barcolor:{type:"string"},backgroundcolor:{type:"string"}}]},a}(n)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(25)],i=function(t,e,n){"use strict";var r;return r=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.center=function(){return{x:this.get("cx"),y:this.get("cy")}},r.prototype.shape=function(t){return t.arc(this.get("cx"),this.get("cy"),this.get("r"),0,2*Math.PI,!1)},r.prototype.handles=function(){return["circle-handle"]},r.prototype.positions=function(){return[["cx","cy"]]},r.prototype.dockPoints=function(){var t,e,n,r,i,o;for(e=this.get("cx"),n=this.get("cy"),i=this.get("r"),r=[],t=o=0;359>=o;t=o+=45)r.push([e+Math.cos(t*Math.PI/180)*i,n-Math.sin(t*Math.PI/180)*i]);return r},r.spec={type:"circle",source:"core:shape.Circle",containable:!1,description:"Circle",dependencies:{"circle-handle":n},properties:[e.spec.properties,{cx:{type:"number","default":0},cy:{type:"number","default":0},r:{type:"number","default":100}}]},r}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(44)],i=function(t,e,n,r){"use strict";var i;return i=function(i){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,i),o.prototype.shape=function(t){var e,n,r,i,o,s,a;return s=this.get("x"),a=this.get("y"),o=this.get("w"),r=this.get("h"),e=s+o/2,n=a+r/2,i=o/2,t.save(),t.scale(1,r/o),t.arc(e,n*o/r,i,0,2*Math.PI,!1),t.restore()},o.spec={type:"ellipse",source:"core:shape.Ellipse",containable:!1,description:"Ellipse",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[t.spec.properties,r]},o}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(44)],i=function(t,e,n,r){"use strict";var i,o,a,c,u;return a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxQjE5RkJCRDBDNTgxMUU0QTVGNEQ5RDg5NURCQUE1MSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxQjE5RkJCRTBDNTgxMUU0QTVGNEQ5RDg5NURCQUE1MSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjkwNTBFREMwMEMyOTExRTRBNUY0RDlEODk1REJBQTUxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFCMTlGQkJDMEM1ODExRTRBNUY0RDlEODk1REJBQTUxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+EIm4tgAAAM9JREFUeNrs2jEKwjAUBuBGegoFz6KbzjlnZkfPouA5ohG7lA6CVALv+6dH6JB8fa8U2lRrHSJnMwQPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgCgZpyKltA0N0FJrfUQ6/Oum77oegfv5uGr9Rpg+j7cRmDqglPLVBnPOq1073/D+cl3E+WW9+w74S1oHfLqgdUBXuZ0Oq9btzIsjEOkhOM4Xok1A8o+QV2EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIfIUYAC90yH3CRmYMwAAAABJRU5ErkJggg==",u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5MDUwRURCRTBDMjkxMUU0QTVGNEQ5RDg5NURCQUE1MSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5MDUwRURCRjBDMjkxMUU0QTVGNEQ5RDg5NURCQUE1MSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjkwNTBFREJDMEMyOTExRTRBNUY0RDlEODk1REJBQTUxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjkwNTBFREJEMEMyOTExRTRBNUY0RDlEODk1REJBQTUxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+7sUUWAAAAJxJREFUeNrs1rENgDAMBMAYZQoYg9UYg9UYgzkCNKkoaKDA92WUNKeXnWitlcwJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABypHaJiDE1wJWzDXuq+kdMQ0meene4bvHo8TK31+5+lfQN6FvgGoJmQPYG+AgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgrzkEGABRjr72QvS8kQAAAABJRU5ErkJggg==",c=new Image,c.src=u,o=new Image,o.src=a,i=function(i){function a(){return a.__super__.constructor.apply(this,arguments)}return s(a,i),a.prototype.capture_shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},a.prototype.resize=function(){var t;switch(this.state){case"loaded":t=this.image;break;case"error":t=o;break;default:t=c}return this.set({w:this.config("w")?this.get("w"):t.width,h:this.config("h")?this.get("g"):t.width})},a.prototype.onadded=function(){var t;return this.image=new Image,this.state="loading",this.resize(),t=this,this.image.onload=function(){return t.state="loaded",t.resize()},this.image.onerror=function(){return t.state="error",t.resize()},this.image.src=this.get("src")},a.prototype.shape=function(t){var e;switch(this.state){case"loaded":e=this.image;break;case"error":e=o;break;default:e=c}return t.drawImage(e,this.get("x"),this.get("y"),this.get("w"),this.get("h"))},a.prototype.event_map=function(){var t;return t={"(self)":{"(self)":{change:function(t,e,n){return n.hasOwnProperty("src")?(this.state="loading",this.image.src=n.src):void 0}}}}},a.spec={type:"image",source:"core:shape.ImageBox",containable:!1,description:"ImageBox",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[t.spec.properties,r,{src:{type:"string"}}]},a}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(28),n(54)],i=function(t,e,n,r){"use strict";var i;return i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype.center=function(){var t,e,n,r,i,o,s;for(e=this.get("path"),n=e.length,r=0,i=0,o=0,s=e.length;s>o;o++)t=e[o],r+=t[0],i+=t[1];return{x:r/n,y:i/n}},i.prototype.shape=function(t){var e,n,r,i,o,s;for(n=this.get("path"),r=n.length,i=n[0],t.moveTo(i[0],i[1]),s=[],e=o=0;r>=0?r>o:o>r;e=r>=0?++o:--o)s.push(t.lineTo(n[e][0],n[e][1]));return s},i.prototype.handles=function(){return["path-handle"]},i.prototype.positions=function(){return"path"},i.prototype.dockPoints=function(){return this.get("path")},i.prototype.event_map=function(){},i.spec={type:"path",source:"core:shape.Path",containable:!1,description:"Path",dependencies:{"path-handle":n},properties:[e.spec.properties,r]},i}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(44)],i=function(t,e,n,r){"use strict";var i;return i=function(i){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,i),o.prototype.shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},o.spec={type:"rect",source:"core:shape.Rect",containable:!1,description:"Rectangle",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[t.spec.properties,r]},o}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(44),n(55)],i=function(t,e,n,r,i){"use strict";var o,a;return o=3.779527559,a=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return s(c,a),c.prototype.capture_shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},c.prototype.shape=function(t){var e;return e=this.bound(),t.rect(e.x,e.y,e.w,e.h),"vertical"!==this.get("direction")?this.drawHorizontal(t,e):this.drawVertical(t,e)},c.prototype.drawHorizontal=function(t,e){var n,r,i,s,a,c,u,p,h,l,f,d,g,y,_,v,m,x,b,w,A;for(d=parseInt(this.get("zeropos")),l=e.x+d,s=e.x+this.get("margin")[0],a=e.x+e.w-this.get("margin")[1],n=e.y+e.h-15,r=e.y+e.h,h=e.w-d,p=Math.ceil(h/o),i=g=0,m=p-1;(m>=0?m>=g:g>=m)&&(f=l+i*o,!(f>a));i=m>=0?++g:--g)s>f||(i%10===0?(t.moveTo(f,n),t.lineTo(f,r)):i%5===0?(t.moveTo(f,n+8),t.lineTo(f,r)):(t.moveTo(f,n+11),t.lineTo(f,r)));for(u=d,c=Math.floor(u/o),i=y=1,x=c-1;(x>=1?x>=y:y>=x)&&(f=l-i*o,!(s>f));i=x>=1?++y:--y)f>a||(i%10===0?(t.moveTo(f,n),t.lineTo(f,r)):i%5===0?(t.moveTo(f,n+8),t.lineTo(f,r)):(t.moveTo(f,n+11),t.lineTo(f,r)));for(t.textAlign="left",t.textBaseline="bottom",i=_=0,b=p-1;b>=_&&(f=l+i*o,!(f>a));i=_+=10)s>f||t.fillText(""+i/10,f+2,n+10);for(A=[],i=v=10,w=c-1;w>=v&&(f=l-i*o,!(s>f));i=v+=10)f>a||A.push(t.fillText("-"+i/10,f+2,n+10));return A},c.prototype.drawVertical=function(t,e){var n,r,i,s,a,c,u,p,h,l,f,d,g,y,_,v,m,x,b,w,A;for(d=parseInt(this.get("zeropos")),l=e.y+d,a=e.y+this.get("margin")[0],s=e.y+e.h-this.get("margin")[1],n=e.x+e.w-15,r=e.x+e.w,p=e.h-d,h=Math.ceil(p/o),i=g=0,m=h-1;(m>=0?m>=g:g>=m)&&(f=l+i*o,!(f>s));i=m>=0?++g:--g)a>f||(i%10===0?(t.moveTo(n,f),t.lineTo(r,f)):i%5===0?(t.moveTo(n+8,f),t.lineTo(r,f)):(t.moveTo(n+11,f),t.lineTo(r,f)));for(c=d,u=Math.floor(c/o),i=y=1,x=u-1;x>=1?x>=y:y>=x;i=x>=1?++y:--y)if(f=l-i*o,!(f>s)){if(a>f)break;i%10===0?(t.moveTo(n,f),t.lineTo(r,f)):i%5===0?(t.moveTo(n+8,f),t.lineTo(r,f)):(t.moveTo(n+11,f),t.lineTo(r,f))}for(t.textAlign="right",t.textBaseline="top",i=_=0,b=h-1;b>=_&&(f=l+i*o,!(f>s));i=_+=10)a>f||t.fillText(""+i/10,n+10,f+2);for(A=[],i=v=10,w=u-1;w>=v&&(f=l-i*o,!(a>f));i=v+=10)f>s||A.push(t.fillText("-"+i/10,n+10,f+2));return A},c.spec={type:"ruler",source:"core:shape.Ruler",containable:!1,description:"Ruler",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[t.spec.properties,r,i,{zeropos:{type:"number","default":0},direction:{type:"string","default":"horizontal"},margin:{type:"array","default":[0,0]}}]},c}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(44),n(55)],i=function(t,e,n){"use strict";var r;return r=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,r),i.prototype._wrap=function(t,e,n,r,i,o){var s,a,c,u,p,h,l,f,d;for(l=e.split(" "),a="",s=f=0,d=l.length;d>f;s=++f)h=l[s],u=a+h+" ",c=t.measureText(u),p=c.width,p>i&&s>0?(t.fillText(a,n,r),a=h+" ",r+=o):a=u;return t.fillText(a,n,r)},i.prototype.shape=function(t){return this._wrap(t,this.get("text"),this.get("x"),this.get("y"),this.get("w"),10),t.font=this.get("font")},i.spec={type:"text",source:"core:shape.Text",containable:!1,description:"Text Box",dependencies:{},properties:[t.spec.properties,e,n,{text:{type:"string","default":""}}]},i
}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(27),n(56)],i=function(t,e,n,r){"use strict";var i;return i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype.center=function(){return{x:(this.get("x1")+this.get("x2"))/2,y:(this.get("y1")+this.get("y2"))/2}},i.prototype.shape=function(t){return t.moveTo(this.get("x1"),this.get("y1")),t.lineTo(this.get("x2"),this.get("y2"))},i.prototype.handles=function(){return["p2p-handle"]},i.prototype.positions=function(){return[["x1","y1"],["x2","y2"]]},i.prototype.dockPoints=function(){return[[this.get("x1"),this.get("y1")],[this.get("x2"),this.get("y2")]]},i.prototype.event_map=function(){},i.spec={type:"line",source:"core:shape.Line",containable:!1,description:"Direct Line",dependencies:{"p2p-handle":n},properties:[e.spec.properties,r]},i}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(16),n(57)],i=function(t,e,n){"use strict";var r,i;return i={debug:function(t,e){var r,i;return r=function(t){return function(){return t.debug_layer||(t.debug_layer?void 0:t.debug_layer=t.select("debug-layer")[0])}}(this),i=function(t){return function(){return t.debug_text||(t.debug_text?void 0:t.debug_text=t.select("text",r())[0])}}(this),i().set("text",t+":"+n(e)),r().draw()}},r=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,n),r.spec={type:"debug-layer",source:"core:layer.DebugLayer",containable:!0,container_type:"layer",description:"Debug Layer",dependencies:{text:e},properties:[t.spec.properties],components:[{type:"text",name:"debug-text",config:{text:"",x:0,y:20,w:300,h:300,capturable:!1}}],exports:i},r}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(42),n(10)],i=function(t,e,n){"use strict";var r,i,o,a,c,u;return a={ondragstart:function(t){return this.handle_last_position={x:t.offsetX,y:t.offsetY}},ondrag:function(t){var e,n,r,i;return e={x:t.offsetX-this.handle_last_position.x,y:t.offsetY-this.handle_last_position.y},n=this.get("x")+e.x,r=this.get("y")+e.y,i={x:n,y:r},this.set(i),this.handle_last_position={x:t.offsetX,y:t.offsetY},this.draw()},ondragend:function(){return this.handle_last_position=null}},o={ondragstart:function(t){return this.edge_last_position={x:t.offsetX,y:t.offsetY},this.last_ratio=this.get("ratio")},ondrag:function(t){var e,n;return e=t.offsetY-this.edge_last_position.y,n=Math.min(Math.max(this.last_ratio+e/20,.5),4),this.set("ratio",n),this.draw()},ondragend:function(){return this.edge_last_position=null}},u=function(){return this.draw()},c=function(t,e,n){return n.hasOwnProperty("x")&&(this.canvas.style.left=n.x+"px"),n.hasOwnProperty("y")&&(this.canvas.style.top=n.y+"px"),n.hasOwnProperty("r")?(this.set({w:2*n.r,h:2*n.r}),this.canvas.setAttribute("width",2*n.r),this.canvas.setAttribute("height",2*n.r)):void 0},r={"?target":{"(all)":{change:u}},"(self)":{"(self)":{change:c},"#magnify-handle":{dragstart:a.ondragstart,drag:a.ondrag,dragend:a.ondragend},"#magnify-edge":{dragstart:o.ondragstart,drag:o.ondrag,dragend:o.ondragend}}},i=function(i){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,i),o.prototype.onadded=function(){var t;return this.target=this.select(this.get("target"))[0],this.magnify_edge=this.select("#magnify-edge")[0],t=this.get("r"),this.set({resizable:!1,w:2*t,h:2*t,x:this.target.canvas.width/2-t,y:this.target.canvas.height/2-t}),this.canvas.setAttribute("width",2*t),this.canvas.setAttribute("height",2*t),this.magnify_edge.set({cx:t,cy:t,r:t-5})},o.prototype._draw=function(){var t,e,n,r,i,o,s,a,c,u,p,h,l,f,d,g,y,_,v;if(this.target)return this.clearCanvas(),t=this.canvas.getContext("2d"),t.save(),t.beginPath(),u=this.get("r"),p=this.get("ratio"),t.arc(u,u,u-1,0,2*Math.PI,!1),t.clip(),t.rect(0,0,2*u,2*u),this.get("fillStyle")&&(t.fillStyle=this.get("fillStyle"),t.fill()),f=this.get("x")-this.target.get("x")+u,d=this.get("y")-this.target.get("y")+u,l=Math.round(u/p),h=l,o=f-l,s=d-h,i=2*l,r=2*h,_=0,v=0,y=2*u,g=2*u,0>o&&(_+=Math.round(-o*p),y-=_,i-=-o,o=0),0>s&&(v+=Math.round(-s*p),g-=v,r-=-s,s=0),a=this.target.canvas.width,n=o+i-a,n>0&&(i-=n,y-=Math.round(n*p)),c=this.target.canvas.height,e=s+r-c,e>0&&(r-=e,g-=Math.round(e*p)),t.drawImage(this.target.canvas,o,s,i,r,_,v,y,g),t.restore(),this.forEach(function(e){return e.draw(t)})},o.prototype.event_map=function(){return[r,e]},o.spec={type:"magnify-layer",source:"core:layer.MagnifyLayer",containable:!0,container_type:"layer",description:"Magnify Layer",dependencies:{circle:n},properties:[t.spec.properties,{target:{type:"string"},r:{type:"number"},ratio:{type:"number"}}],components:[{type:"circle",config:{id:"magnify-edge",cx:100,cy:100,r:95,lineWidth:10,strokeStyle:"black",capturable:!0,draggable:!0}},{type:"circle",config:{id:"magnify-handle",cx:180,cy:180,r:16,lineWidth:8,strokeStyle:"black",fillStyle:"red",capturable:!0,draggable:!0}}]},o}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(15),n(42)],i=function(t,e,n){"use strict";var r;return r=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,r),i.prototype.onadded=function(){var t;return this.target=this.select(this.get("target"))[0],t=this.select("ruler",this),this.hori=t[0],this.vert=t[1],this.hori.set({w:this.target.canvas.width,h:20,zeropos:this.target.get("offset-x")}),this.vert.set({w:20,h:this.target.canvas.height,zeropos:this.target.get("offset-y")}),this.set({x:this.target.get("x"),y:this.target.get("y"),w:this.target.get("w"),h:this.target.get("h")})},i.prototype.event_map=function(){return[n,{"?target":{"?target":{change:this.onchange}}}]},i.prototype.onchange=function(t,e,n){var r,i,o;return r={},o={},n.hasOwnProperty("offset-x")&&(r.zeropos=n["offset-x"]),n.hasOwnProperty("offset-y")&&(o.zeropos=n["offset-y"]),n.hasOwnProperty("w")&&(r.w=n.w),n.hasOwnProperty("h")&&(o.h=n.h),i=_.pick(n,["x","y","w","h"]),_.isEmpty(i)||this.silentSet(i),_.isEmpty(r)||this.hori.silentSet(r),_.isEmpty(o)||this.vert.silentSet(o),this.draw()},i.spec={type:"ruler-layer",source:"core:layer.RulerLayer",containable:!0,container_type:"layer",description:"Ruler Layer",dependencies:{ruler:e},properties:[t.spec.properties,{target:{type:"string"}}],components:[{type:"ruler",config:{direction:"horizontal",margin:[20,0],opacity:.8,x:0,y:0,zeropos:20,strokeStyle:"navy",lineWidth:1}},{type:"ruler",config:{direction:"vertical",margin:[20,0],opacity:.8,x:0,y:0,zeropos:20,strokeStyle:"navy",lineWidth:1}}]},i}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(42)],i=function(t,e){"use strict";var n,r,i,o,a,c,u,p,h,l,f,d;return d=function(t,e){return _.contains(t,e)?_.pull(t,e):t.unshift(e),t},l=function(t,e){return _.contains(t,e)?t:[e]},f=function(t,e){return _.contains(t,e)?t:(t.unshift(e),t)},u=function(t){return this.selections=t.origin.shiftKey?f(this.selections,t.target):l(this.selections,t.target),this.setFocus(this.selections[0]),this.draglast_position={x:t.offsetX,y:t.offsetY}},a=function(t){return this.offset={x:t.offsetX-this.draglast_position.x,y:t.offsetY-this.draglast_position.y},this.draw()},c=function(){var t,e,n,r;for(r=this.selections,e=0,n=r.length;n>e;e++)t=r[e],t.move&&t.move({delta:this.offset},!0);return this.offset=null,this.draw()},o=function(t){return this.selections=t.origin.shiftKey?d(this.selections,t.target):l(this.selections,t.target),this.setFocus(this.selections[0]),this.draw()},i=function(t,e,n){var r;return r=_.pick(n,["offset-x","offset-y","x","y"]),_.isEmpty(r)?void 0:this.set(r)},p=function(t,e,n){return n.hasOwnProperty("x")&&(this.canvas.style.left=n.x+"px"),n.hasOwnProperty("y")&&(this.canvas.style.top=n.y+"px"),this.draw()},n={"?target":{"(all)":{click:o,tap:o,dragstart:u,drag:a,dragend:c},"?target":{change:i}},"(self)":{"(self)":{change:p}}},h=function(t,e,n){var r,i,o;return i=t.getContainer(),i.canvas||h(i,e,!0),n?(o=t.get("rotate")||0,r=t.center(),e.translate(r.x,r.y),e.rotate(o*Math.PI/180),e.translate(-r.x,-r.y),e.translate(t.get("x"),t.get("y"))):void 0},r=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,r),i.prototype.capture=function(t){var e,n,r,i,o,s,a;if(r=this.canvas.getContext("2d"),r.beginPath(),o={x:t.x-this.get("offset-x")-this.get("x"),y:t.y-this.get("offset-y")-this.get("y")},this.shape(r),this.size()>0)for(i=s=a=this.size()-1;0>=a?0>=s:s>=0;i=0>=a?++s:--s)if(n=this.getAt(i),e=n.capture(o,r))return e;return null},i.prototype.onadded=function(){var t;return this.selections=[],this.target=this.select(this.get("target"))[0],t={"offset-x":this.get("offset-x")||this.target.get("offset-x"),"offset-y":this.get("offset-y")||this.target.get("offset-y"),x:this.get("x")||this.target.get("x"),y:this.get("y")||this.target.get("y"),w:this.target.get("w"),h:this.target.get("h")},this.set(t)},i.prototype._draw=function(){var t,e,n,r,i;if(this.selections){if(this.clearCanvas(),t=this.canvas.getContext("2d"),t.save(),t.translate(this.get("offset-x"),this.get("offset-y")),t.globalAlpha=.4,this.selections.length>0){for(t.save(),this.offset&&t.translate(this.offset.x,this.offset.y),i=this.selections,n=0,r=i.length;r>n;n++)e=i[n],t.save(),h(e,t),e.draw(t),t.restore();t.restore()}return t.globalAlpha=1,this.focus&&this.forEach(function(e){return e.draw(t)}),t.restore()}},i.prototype.buildHandles=function(){var t,e,n,r,i;for(r=this.focus.handles(),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.build({type:t,config:{target:"#"+this.focus.get("id")}}));return i},i.prototype.setFocus=function(t){return this.focus!==t&&(this.removeAll(),this.focus=t,this.focus)?(this.buildHandles(),this.draw()):void 0},i.prototype.event_map=function(){return[n,e]},i.spec={type:"selection-layer",source:"core:layer.SelectionLayer",containable:!0,container_type:"layer",description:"Selection Layer",dependencies:{},properties:[t.spec.properties,{target:{type:"string"}}]},i}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(42),n(10)],i=function(t,e,n){"use strict";var r,i,o,a,c;return c=function(t){return this.slide_last_position={x:t.offsetX,y:t.offsetY}},o=function(t){var e,n;return e={x:t.offsetX-this.slide_last_position.x,y:t.offsetY-this.slide_last_position.y},this.slide_target=this.slide_target||this.select(this.get("target"))[0],n={x:this.slide_target.get("offset-x"),y:this.slide_target.get("offset-y")},this.slide_target.set({"offset-x":n.x+e.x,"offset-y":n.y+e.y}),this.slide_handle.move({delta:e}),this.slide_last_position={x:t.offsetX,y:t.offsetY},this.draw()},a=function(){return this.slide_last_position=null,this.slide_handle.set({cx:this.canvas.width/2-this.get("offset-x"),cy:this.canvas.height/2-this.get("offset-y")}),this.draw()},r={"(self)":{"#slide-handle":{dragstart:c,drag:o,dragend:a}}},i=function(i){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,i),o.prototype.onadded=function(){return this.slide_handle=this.select("#slide-handle")[0],this.slide_handle.set({cx:this.canvas.width/2-this.get("offset-x"),cy:this.canvas.height/2-this.get("offset-y")}),this.draw()},o.prototype._draw=function(){var t,e;return this.clearCanvas(),t=this.canvas.getContext("2d"),e={x:this.get("offset-x"),y:this.get("offset-y")},t.translate(e.x,e.y),t.globalAlpha=.5,this.outline_target&&(this.offset&&t.translate(this.offset.x,this.offset.y),this.outline_target.draw(t),this.offset&&t.translate(-this.offset.x,-this.offset.y)),t.globalAlpha=1,this.forEach(function(e){return e.draw(t)}),t.translate(-e.x,-e.y)},o.prototype.event_map=function(){return[r,e]},o.spec={type:"slide-layer",source:"core:layer.SlideLayer",containable:!0,container_type:"layer",description:"Slide Layer",dependencies:{circle:n},properties:[t.spec.properties,{target:{type:"string"}}],components:[{type:"circle",config:{id:"slide-handle",cx:100,cy:100,r:20,lineWidth:5,strokeStyle:"red",fillStyle:"black",capturable:!0,draggable:!0}}]},o}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3)],i=function(t){"use strict";var e;return e=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.model=function(t){var e,n,r,i,o;if(t.components){for(i=t.components,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.build(e,this));return o}},n.spec={type:"widget-layer",source:"core:layer.WidgetLayer",containable:!0,container_type:"layer",description:"Widgets Layer",dependencies:{},properties:[t.spec.properties]},n}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4)],i=function(t,e){"use strict";var n,r,i,o,a,c,u,p;return u=-1,a=0,n=1,o=-1,i=0,c=1,p=[[o,u],[i,u],[c,u],[o,a],[c,a],[o,n],[i,n],[c,n]],r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t,e,n,r,i;return t=this.target.bound(),i=Math.round(t.w/2),r=Math.round(t.h/2),e=Math.round(t.x+i),n=Math.round(t.y+r),this.forEach(function(t){var o;return o=t.get("index"),t.set({x:e+p[o][0]*i,y:n+p[o][1]*r})})},n.prototype.onadded=function(){var t,e,n,r;if(this.set("clip",!1),this.target=this.select(this.get("target"))[0],this.target.get("resizable")){for(t=n=0,r=p.length;r>n;t=++n)e=p[t],this.build({type:"handle",config:{r:8,strokeStyle:"red",lineWidth:2,capturable:!1,fillStyle:"black",index:t,draggable:!0}});return this.align()}},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,i;return n=t.target,e={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},r=n.get("index"),i={w:this.target.get("w")+e.x*p[r][0],h:this.target.get("h")+e.y*p[r][1]},p[r][0]===o&&(i.x=this.target.get("x")+e.x),p[r][1]===u&&(i.y=this.target.get("y")+e.y),this.target.set(i),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){return this.target.configure(this.target.bound())},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"bound-handle",source:"core:handle.BoundHandle",containable:!0,description:"Bound Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4)],i=function(t,e){"use strict";var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t,e,n,r;return n=this.target.get("r"),t=this.target.get("cx"),e=this.target.get("cy"),r=this.get("theta")||0,this.handle.set({x:t+Math.round(Math.cos(r)*n),y:e+Math.round(Math.sin(r)*n)})},n.prototype.onadded=function(){return this.set("clip",!1),this.set("theta",0),this.target=this.select(this.get("target"))[0],this.handle=this.build({type:"handle",config:{r:8,index:0,strokeStyle:"red",fillStyle:"black",lineWidth:1,draggable:!0}}),this.align()},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,i,o,s,a;return i=t.target,e={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},o=i.get("x")+e.x,s=i.get("y")+e.y,i.set({x:o,y:s}),n=o-this.target.get("cx"),r=s-this.target.get("cy"),this.set({theta:Math.atan2(r,n)}),a=Math.round(Math.sqrt(n*n+r*r)),this.target.set({r:a}),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"circle-handle",source:"core:handle.CircleHandle",containable:!0,description:"Circle Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(7),n(49),n(43),n(45)],i=function(t,e,n,r){"use strict";var i,o;return o=function(t,e,n){var r,i,s;return i=t.getContainer(),i.canvas||o(i,e,!0),n?(s=t.get("rotate")||0,r=t.center(),e.translate(r.x,r.y),e.rotate(s*Math.PI/180),e.translate(-r.x,-r.y),e.translate(t.get("x"),t.get("y"))):void 0},i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.include(e),i.prototype.center=function(){return{x:this.get("x"),y:this.get("y")}},i.prototype.shape=function(t){var e,n,r;return r=this.getContainer().target,t.save(),o(r,t),e=r.center(),n=r.get("rotate"),t.translate(e.x,e.y),t.rotate(n*Math.PI/180),t.translate(-e.x,-e.y),t.arc(this.get("x"),this.get("y"),this.get("r"),0,2*Math.PI,!1),t.restore()},i.prototype.event_map=function(){return[]},i.spec={type:"handle",source:"core:handle.Handle",containable:!1,description:"Base Handle",dependencies:{},properties:[n,r,{x:{type:"number"},y:{type:"number"},r:{type:"number"},index:{type:"string"}}]},i}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4),n(43),n(45)],i=function(t,e){"use strict";var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t;return t=[[this.target.get("x1"),this.target.get("y1")],[this.target.get("x2"),this.target.get("y2")]],this.forEach(function(e){var n;return n=e.get("index"),e.set({x:t[n][0],y:t[n][1]})})},n.prototype.onadded=function(){var t,e;for(this.set("clip",!1),this.target=this.select(this.get("target"))[0],t=e=0;1>=e;t=++e)this.build({type:"handle",config:{r:8,index:t,strokeStyle:"red",fillStyle:"black",lineWidth:2,draggable:!0}});return this.align()},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,i,o,s;switch(n=t.target,e={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},i=n.get("x")+e.x,o=n.get("y")+e.y,n.set({x:i,y:o}),r=n.get("index")){case 0:s={x1:this.target.get("x1")+e.x,y1:this.target.get("y1")+e.y};break;case 1:s={x2:this.target.get("x2")+e.x,y2:this.target.get("y2")+e.y}}return this.target.set(s),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){return this.target.configure({x1:this.target.get("x1"),y1:this.target.get("y1"),x2:this.target.get("x2"),y2:this.target.get("y2")})},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"p2p-handle",source:"core:handle.P2PHandle",containable:!0,description:"Point-to-Point Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(26),n(58),n(4)],i=function(t,e,n,r){"use strict";var i;return i=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,r),i.prototype.align=function(){var t,e;return t=this.target.get("path"),e=t.length,this.forEach(function(n){var r,i;return i=n.get("index"),e>i?n.set({x:t[i][0],y:t[i][1]}):(r=i-e,n.set({x:(t[r][0]+t[r+1][0])/2,y:(t[r][1]+t[r+1][1])/2}))})},i.prototype.buildHandles=function(){var t,e,n,r,i,o;for(this.removeAll(),e=this.target.get("path"),t=n=0,i=e.length-1;i>=0?i>=n:n>=i;t=i>=0?++n:--n)this.build({type:"handle",config:{r:8,index:t,strokeStyle:"red",fillStyle:"black",lineWidth:2,draggable:!0}});for(t=r=0,o=e.length-2;o>=0?o>=r:r>=o;t=o>=0?++r:--r)this.build({type:"split-handle",config:{r:8,index:e.length+t,strokeStyle:"red",fillStyle:"black",lineWidth:2,draggable:!0}});return this.align()},i.prototype.onadded=function(){return this.set("clip",!1),this.target=this.select(this.get("target"))[0],this.buildHandles()},i.prototype.onchange=function(){return this._split_mode||this.align(),this.draw()},i.prototype.path_handle={ondragstart:function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},ondrag:function(e){var n,r,i,o,s,a;return r=e.target,n={x:e.offsetX-this.startpos.x,y:e.offsetY-this.startpos.y},o=r.get("x")+n.x,s=r.get("y")+n.y,r.set({x:o,y:s}),i=r.get("index"),a=t.clone(this.target.get("path")),a[i][0]=o,a[i][1]=s,this.target.set("path",a),this.startpos={x:e.offsetX,y:e.offsetY}},ondragend:function(){return this.target.configure("path",this.target.get("path"))}},i.prototype.split_handle={ondragstart:function(e){var n,r,i;return this._split_mode=!0,this.startpos={x:e.offsetX,y:e.offsetY},n=e.target,i=t.clone(this.target.get("path")),r=n.get("index")-i.length,i.splice(r+1,0,[e.offsetX,e.offsetY]),this.target.set("path",i)},ondrag:function(e){var n,r,i,o,s,a;return r=e.target,n={x:e.offsetX-this.startpos.x,y:e.offsetY-this.startpos.y},o=r.get("x")+n.x,s=r.get("y")+n.y,r.set({x:o,y:s}),a=t.clone(this.target.get("path")),i=r.get("index")-a.length+2,a[i][0]=o,a[i][1]=s,this.target.set("path",a),this.startpos={x:e.offsetX,y:e.offsetY}},ondragend:function(){return this._split_mode=!1,this.target.configure("path",this.target.get("path")),this.buildHandles()}},i.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.path_handle.ondragstart,drag:this.path_handle.ondrag,dragend:this.path_handle.ondragend},"split-handle":{dragstart:this.split_handle.ondragstart,drag:this.split_handle.ondrag,dragend:this.split_handle.ondragend}}}},i.spec={type:"path-handle",source:"core:handle.PathHandle",containable:!0,description:"Path Handle",dependencies:{handle:e,"split-handle":n},properties:[{target:{type:"string"}}]},i}(r)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4)],i=function(t,e){"use strict";var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t,e,n,r,i;return t=this.target.bound(),i=Math.round(t.w/2),r=Math.round(t.h/2),e=Math.round(t.x+t.w/2),n=Math.round(t.y-20),this.handle.set({x:e,y:n})},n.prototype.onadded=function(){return this.set("clip",!1),this.target=this.select(this.get("target"))[0],this.handle=this.build({type:"handle",config:{r:8,draggable:!0,strokeStyle:"red",fillStyle:"black",lineWidth:1}}),this.align()},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,i,o,s,a,c;return r=t.target,n={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},i=r.get("index"),e=this.target.bound(),o=Math.round(e.x+e.w/2),s=Math.round(e.y+e.h/2),c=Math.atan2(t.offsetY-s,t.offsetX-o),c-=Math.atan2(this.startpos.y-s,this.startpos.x-o),a=this.target.get("rotate")||0,this.target.set({rotate:a+180*c/Math.PI}),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){return this.target.configure("rotate",this.target.get("rotate"))},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"rotation-handle",source:"core:handle.RotationHandle",containable:!0,description:"Rotation Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n;e=[],n=function(){var t,e,n,r,i;return n=window.devicePixelRatio,n||(n=(window.matchMedia&&window.matchMedia("(min-resolution: 2dppx), (-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches?2:1)||1),i=Math.round(screen.width*n),r=Math.round(screen.height*n),e=function(t){var e;return i>0||(i=1),r>0||(r=1),e=Math.sqrt(i*i+r*r)/t,e>0?Math.round(e):0},t={version:"@@version",calcDpi:e,listenClickTap:!1,inDblClickWindow:!1,enableTrace:!1,traceArrMax:100,dblClickWindow:400,pixelRatio:void 0,dragDistance:0,angleDeg:!0,showWarnings:!0,Filters:{},isDragging:function(){var t;return t=things.DD,t?t.isDragging:!1},isDragReady:function(){var t;return t=things.DD,t?!!t.node:!1},_parseUA:function(t){var e,n,r,i;return i=t.toLowerCase(),n=/(chrome)[ \/]([\w.]+)/.exec(i)||/(webkit)[ \/]([\w.]+)/.exec(i)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(i)||/(msie) ([\w.]+)/.exec(i)||i.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(i)||[],r=!!t.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),e=!!t.match(/IEMobile/i),{browser:n[1]||"",version:n[2]||"0",mobile:r,ieMobile:e}},UA:void 0},t.UA=t._parseUA(navigator&&navigator.userAgent||""),console.log("UA",t.UA),t}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i,o={}.hasOwnProperty;r=[n(39)],i=function(t){"use strict";var e;return e=function(){function e(){this.componentSpecs={}}return e.prototype.dispose=function(){var t,e,n,r,i;for(t=Object.keys(this.componentSpecs),i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(this.unregister(e));return i},e.prototype.setRegisterCallback=function(t,e){return this.callback_register="function"==typeof t?t.bind(e):void 0},e.prototype.setUnregisterCallback=function(t,e){return this.callback_unregister="function"==typeof t?t.bind(e):void 0},e.prototype.register=function(e,n){var r,i,o,s,a,c,u,p;if(!this.componentSpecs[e]){if(n.spec.dependencies){u=n.spec.dependencies;for(o in u)r=u[o],this.register(o,r)}if(n.spec.properties instanceof Array){for(s={},p=t.flatten(n.spec.properties),a=0,c=p.length;c>a;a++)i=p[a],t.merge(s,i);n.spec.properties=s}return this.componentSpecs[e]=n,this.callback_register?this.callback_register(n.spec):void 0}},e.prototype.unregister=function(t){var e;return(e=this.componentSpecs[t])?(delete this.componentSpecs[t],this.callback_unregister&&this.callback_unregister(e),e):void 0},e.prototype.forEach=function(t,e){var n,r,i,s;i=this.componentSpecs,s=[];for(n in i)o.call(i,n)&&(r=i[n],s.push(t.call(e,n,r)));return s},e.prototype.list=function(){return Object.keys(this.componentSpecs).map(function(t){return this.componentSpecs[t]},this)},e.prototype.get=function(e){var n;return n=this.componentSpecs[e],n?t.clone(this.componentSpecs[e]):null},e}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(7),n(8)],i=function(t,e){"use strict";var n,r,i,o,s,a,c;return r=function(t,e){return t.substr(1)===e.get("id")},o=function(t,e){var n;return n=e.get("tag"),n?n.indexOf(t.substr(1))>-1:!1},i=function(t,e,n,r){switch(t){case"(all)":return!0;case"(self)":return n===e;case"(root)":return r===e;default:return!1}},s=function(t,e){return t===e.type},n=function(t,e,n,a){switch(t.charAt(0)){case"#":return r(t,e,n,a);case".":return o(t,e,n,a);case"(":return i(t,e,n,a);default:return s(t,e,n,a)}},c=function(t,n,r,i,o,s){return t(n,r,i,o)&&s.push(r),r instanceof e&&r.forEach(function(e){return c(t,n,e,i,o,s)}),s},a=function(t,e,n){var a;return"(root)"===t?[e]:"(self)"===t?[n]:(a=function(){switch(t.charAt(0)){case"#":return r;case".":return o;case"(":return i;default:return s}}(),c(a,t,e,n,e,[]))},{select:a,match:n}}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(39)],i=function(t){"use strict";var e;return e=function(){function e(t,e){this.componentRegistry=t,this.controller=e}return e.prototype.dispose=function(){return this.componentRegistry=null,this.controller=null},e.prototype.build=function(t,e){var n;return n=this.createByModel(t),this.setupDescendant(n,t.components),e&&e.add(n),n},e.prototype.create=function(e,n){var r,i,o,s,a,c;if(o=this.componentRegistry.get(e),!o)throw new Error("module ("+model.type+") is not registered yet.");if(n||(n={}),n.hasOwnProperty("id")||(n.id=t.uniqueId()),i=new o(e).initialize(n,o.spec.properties),i.setController(this.controller),i.init&&i.init(),o.spec.components)for(c=o.spec.components,s=0,a=c.length;a>s;s++)r=c[s],this.build(r,i);return i},e.prototype.createByModel=function(t){var e,n,r;if(t.dependencies){r=t.dependencies;for(n in r)e=r[n],this.componentRegistry.register(n,e)}return this.create(t.type,t.config)},e.prototype.setupDescendant=function(t,e){var n,r,i,o,s;if(r=this.componentRegistry.get(t.type),i=r.spec,e)for(o=0,s=e.length;s>o;o++)n=e[o],this.build(n,t);return t},e}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i,o={}.hasOwnProperty;r=[n(39),n(60),n(32)],i=function(t,e,n){"use strict";var r;return r=function(){function r(t){this.eventMaps=[],this.setRoot(t)}return r.prototype.setRoot=function(t){return this.root=t},r.prototype.stop=function(){var t,e,n,r,i;for(r=this.eventMaps,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.eventPump.stop());return i},r.prototype.add=function(t,r,i){var s,a,c,u,p,h,l,f,d,g,y;if(this.root){if(!(r instanceof Array))return void this.add(t,[r],i);for(y=[],d=0,g=r.length;g>d;d++)a=r[d],y.push(function(){var r;r=[];for(u in a)if(o.call(a,u)){if(c=a[u],0===u.indexOf("?")){if(f=u.substr(1),l=t.get(f),!l){console.log("EventEngine#add","variable "+u+" is not evaluated on listener");continue}u=l}h=n.select(u,this.root,t),r.push(function(){var n,r,o;for(o=[],n=0,r=h.length;r>n;n++)p=h[n],s=new e(p),s.on(t,c),s.start(i),o.push(this.eventMaps.push({eventPump:s,listener:t,handlerMap:a,target:p}));return o}.call(this))}return r}.call(this));return y}},r.prototype.remove=function(e,n){var r,i,o,s,a,c;for(o=t.clone(this.eventMaps),c=[],r=s=0,a=o.length;a>s;r=++s)i=o[r],i.listener!==e||n&&i.handlerMap!==n?c.push(void 0):(this.eventMaps.splice(r,1),c.push(i.eventPump.dispose()));return c},r.prototype.clear=function(){var e,n,r,i;for(n=t.clone(this.eventMaps),r=0,i=n.length;i>r;r++)e=n[r],e.eventPump.dispose();
return this.eventMaps=[]},r.prototype.dispose=function(){return this.stop(),this.clear()},r}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t=function(){function t(t){this.binder=t,this.exports={}}return t.prototype.dispose=function(){var t,e,n,r,i;for(e=Object.keys(this.exports),i=[],n=0,r=e.length;r>n;n++)t=e[n],i.push(this.remove(t));return i},t.prototype["import"]=function(t,e,n){var r,i,o;if(e){o={};for(r in e)i=e[r],o[r]=i instanceof Function?i.bind(n||this.binder):i;return this.exports[t]=o}},t.prototype.remove=function(t){return delete this.exports[t]},t.prototype.require=function(t){return this.exports[t]},t}()}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i;r=[n(61),n(62)],i=function(t,e){"use strict";var n,r,i,o,s,a,c;return i=function(n){var r;return r=this.stage.point(n),this.captured=this.stage.capture(r),this.click_target=this.captured,this.captured.get("draggable")&&(t.draggable=!0),e.mousedown(this.captured,n,r),n.preventDefault?n.preventDefault():void 0},c=function(n){var r,i,o;return i=this.stage.point(n),this.captured=this.stage.capture(i),r=!1,this.listening_dbl_click?(r=!0,this.listening_dbl_click=!1):this.listening_dbl_click=!0,o=this,setTimeout(function(){return o.listening_dbl_click=!1},500),this.captured&&!t.dragging&&(e.mouseup(this.captured,n,i),this.click_target&&this.captured===this.click_target&&(e.click(this.captured,n,i),r&&(e.doubleclick(this.captured,n,i),this.listening_dbl_click=!1))),this.click_target=null,n.preventDefault?n.preventDefault():void 0},a=function(n){var r,i,o,s,a;if("undefined"==typeof n.webkitMovementX&&"undefined"==typeof n.webkitMovementY||0!==n.webkitMovementY||0!==n.webkitMovementX){if(a=this.stage.point(n),i=this.captured,this.captured=this.stage.capture(a),!t.dragging&&(this.captured&&e.mousemove(this.captured,n,a),this.captured!==i)){if(o=[this.captured],this.captured)for(;r=(r||this.captured).getContainer();)o.unshift(r);if(s=[i],i)for(;r=(r||i).getContainer();)s.unshift(r);for(;s[0]===o[0];)s.shift(),o.shift();for(;r=s.pop();)e.mouseout(r,n,a);for(;r=o.shift();)e.mouseover(r,n,a)}return t.draggable&&this.captured&&t.drag(this.captured,n,a),n.preventDefault?n.preventDefault():void 0}},s=function(t){var n,r,i;if(!this.dragging){if(this.captured){for(i=this.stage.point(t),n=this.captured,r=[this.captured];n=n.getContainer();)r.unshift(n);for(;n=r.pop();)e.mouseout(n,t,i)}return this.captured=null}},o=function(){},r=function(t){var n;return t.preventDefault(),n=this.stage.point(t),this.captured=this.stage.capture(n),e.contextmenu(this.captured,t,n)},n=function(){function t(t){this.stage=t,this.onmousemove=a.bind(this),this.onmouseleave=s.bind(this),this.onmouseenter=o.bind(this),this.onmouseup=c.bind(this),this.onmousedown=i.bind(this),this.oncontextmenu=r.bind(this),this.stage.html_container.addEventListener("mousemove",this.onmousemove),this.stage.html_container.addEventListener("mouseleave",this.onmouseleave),this.stage.html_container.addEventListener("mouseenter",this.onmouseenter),this.stage.html_container.addEventListener("mouseup",this.onmouseup),this.stage.html_container.addEventListener("mousedown",this.onmousedown),this.stage.html_container.addEventListener("contextmenu",this.oncontextmenu)}return t.prototype.dispose=function(){return this.stage.html_container.removeEventListener("mousemove",this.onmousemove),this.stage.html_container.removeEventListener("mouseleave",this.onmouseleave),this.stage.html_container.removeEventListener("mouseenter",this.onmouseenter),this.stage.html_container.removeEventListener("mouseup",this.onmouseup),this.stage.html_container.removeEventListener("mousedown",this.onmousedown),this.stage.html_container.removeEventListener("contextmenu",this.oncontextmenu)},t}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(62),n(61)],i=function(t,e){"use strict";var n,r,i,o;return o=function(e){var n,r,i;return n=this.stage.point(e),i=this.stage.capture(n),this.tap_target=i,r=this,this.longtouch_triggered=!1,this.longtouch_timer=setTimeout(function(){return r.longtouch_timer=null,i&&t.longtouch(i,e,n),r.longtouch_triggered=!0},500),t.touchstart(i,e,n),e.preventDefault?e.preventDefault():void 0},r=function(n){var r,i,o,s;return i=this.stage.point(n),s=this.stage.capture(i),this.longtouch_timer&&(clearTimeout(this.longtouch_timer),this.longtouch_timer=null),r=!1,this.listening_dbl_click?(r=!0,this.listening_dbl_click=!1):this.listening_dbl_click=!0,o=this,setTimeout(function(){return o.listening_dbl_click=!1},500),s&&!e.dragging&&(t.touchend(s,n,i),this.tap_target&&s===this.tap_target&&(t.tap(s,n,i),r&&(t.doubletap(s,n,i),this.listening_dbl_click=!1))),this.tap_target=null,n.preventDefault?n.preventDefault():void 0},i=function(n){var r,i;if(r=this.stage.point(n),this.longtouch_timer&&e.dragging)clearTimeout(this.longtouch_timer),this.longtouch_timer=null;else if(this.longtouch_triggered)return void(n.preventDefault&&n.preventDefault());return i=this.stage.capture(r),!e.dragging&&i&&(t.touchmove(i,n,r),n.preventDefault&&n.preventDefault()),e.drag(i,n,r),n.preventDefault?n.preventDefault():void 0},n=function(){function t(t){this.stage=t,this.ontouchstart=o.bind(this),this.ontouchmove=i.bind(this),this.ontouchend=r.bind(this),this.stage.html_container.addEventListener("touchstart",this.ontouchstart),this.stage.html_container.addEventListener("touchmove",this.ontouchmove),this.stage.html_container.addEventListener("touchend",this.ontouchend)}return t.prototype.dispose=function(){return this.stage.html_container.removeEventListener("touchstart",this.ontouchstart),this.stage.html_container.removeEventListener("touchmove",this.ontouchmove),this.stage.html_container.removeEventListener("touchend",this.ontouchend)},t}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n,r=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};e=[],n=function(){"use strict";var t,e;return e=["extended","included"],t=function(){function t(){}return t.extend=function(t){var n,i,o;for(n in t)i=t[n],r.call(e,n)<0&&(console.log(n,i),this[n]=i);return null!=(o=t.extended)&&o.apply(this),this},t.include=function(t){var n,i,o;for(n in t)i=t[n],r.call(e,n)<0&&(this.prototype[n]=i);return null!=(o=t.included)&&o.apply(this),this},t}()}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i;r=[n(59)],i=function(t){"use strict";return t}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(64)],i=function(t){"use strict";var e;return e=function(){function e(){this.reset()}return e.prototype.dispose=function(){return this.reset()},e.prototype.execute=function(e){return!e instanceof t?void 0:(e.execute(),this.exq.push(e),this.uxq=[])},e.prototype.undo=function(){var t;return t=this.exq.pop(),t?(t.unexecute(),this.uxq.push(t)):void 0},e.prototype.redo=function(){var t;return t=this.uxq.pop(),t?(t.execute(),this.exq.push(t)):void 0},e.prototype.undoable=function(){return this.exq.length>0},e.prototype.redoable=function(){return this.uxq.length>0},e.prototype.reset=function(){return this.exq=[],this.uxq=[]},e}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(65)],i=function(t){"use strict";var e,n,r,i;return e=function(t,e){var n;return e.event_map&&(n=e.event_map(),this.eventEngine.add(e,n,e)),e.onadded&&e.onadded(t),e.draw()},i=function(t,e){return e.onremoved&&e.onremoved(t),this.eventEngine.remove(e)},r=function(e){return t.show({x:e.origin.pageX,y:e.origin.pageY})},n=function(t,e,n){return console.log("TODO","think about html container on stage width/height change",n),n.hasOwnProperty("w")&&(this.stage.html_container.style.width=n.w+"px"),n.hasOwnProperty("h")?this.stage.html_container.style.height=n.h+"px":void 0},[t,{"(root)":{"(root)":{change:n},"(all)":{add:e,remove:i,contextmenu:r,longtouch:r}}}]}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n;return n=function(){return this.draw()},t=function(t,e,n){return n.hasOwnProperty("x")&&(this.canvas.style.left=n.x+"px"),n.hasOwnProperty("y")&&(this.canvas.style.top=n.y+"px"),n.hasOwnProperty("w")&&this.canvas.setAttribute("width",n.w),n.hasOwnProperty("h")&&this.canvas.setAttribute("height",n.h),this.draw()},e=function(t,e,n){var r,i,o;if(this.get("resizable")!==!1)return r={},i=this.get("x")||0,o=this.get("y")||0,n.hasOwnProperty("w")&&(r.w=n.w-i),n.hasOwnProperty("h")&&(r.h=n.h-o),this.set(r)},{"(root)":{"(root)":{change:e}},"(self)":{"(all)":{added:n,removed:n,change:n},"(self)":{change:t}}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={id:{type:"string"},capturable:{type:"boolean"},draggable:{type:"boolean"},resizable:{type:"boolean"}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={x:{type:"number","default":0},y:{type:"number","default":0},w:{type:"number"},h:{type:"number"},rotate:{type:"number","default":0}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={lineWidth:{type:"number"},fillStyle:{type:"string"},strokeStyle:{type:"string"},alpha:{type:"number"}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={dockType:function(){},dockPoints:function(){var t,e,n,r;return n=this.get("x"),r=this.get("y"),e=this.get("w"),t=this.get("h"),[[n,r],[n+e,r],[n,r+t],[n+e,r+t]]}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={center:function(){return{x:this.get("x")+this.get("w")/2,y:this.get("y")+this.get("h")/2}},shape:function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},draw:function(t){var e,n;return t?(t.beginPath(),n=this.get("rotate")||0,e=this.center(),t.save(),t.translate(e.x,e.y),t.rotate(n*Math.PI/180),t.translate(-e.x,-e.y),this.shape(t),this.get("fillStyle")&&(t.fillStyle=this.get("fillStyle"),t.fill()),this.get("strokeStyle")&&(t.lineWidth=this.get("lineWidth"),t.strokeStyle=this.get("strokeStyle"),t.stroke()),this.get("clip")&&t.clip(),t.translate(this.get("x"),this.get("y")),this.forEach(function(e){return e.draw(t)}),t.restore()):this.getContainer().draw()},capture:function(t,e){var n,r,i,o,s,a,c,u;if(e.beginPath(),r=this.center(),a=(this.get("rotate")||0)*Math.PI/180,e.save(),e.translate(r.x,r.y),e.rotate(a),e.translate(-r.x,-r.y),this.shape(e),e.lineWidth=this.get("lineWidth"),n=null,s=e.isPointInPath(t.x,t.y)||!!this.get("strokeStyle")&&e.isPointInStroke(t.x,t.y),(!this.get("clip")||s)&&this.size()>0)for(e.translate(this.get("x"),this.get("y")),o=c=u=this.size()-1;(0>=u?0>=c:c>=0)&&(i=this.getAt(o),!(n=i.capture(t,e)));o=0>=u?++c:--c);return e.restore(),n?n:this.get("capturable")===!1?null:s?this:null}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={objectify:function(){var t,e;return"function"==typeof this.forEach&&(t=[],this.forEach(function(e){return t.push(e.objectify())})),e={type:this.type,config:this.config()},t&&(e.components=t),e},serialize:function(){return JSON.stringify(this.objectify())}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={bound:function(){return{x:this.get("x"),y:this.get("y"),w:this.get("w"),h:this.get("h")}},center:function(){var t;return t=this.bound(),{x:t.x+t.w/2,y:t.y+t.h/2}},shape:function(){},capture_shape:function(t){return this.shape(t)},draw:function(t){var e,n;return t?(t.beginPath(),n=this.get("rotate")||0,e=this.center(),t.save(),t.translate(e.x,e.y),t.rotate(n*Math.PI/180),t.translate(-e.x,-e.y),this.shape(t),this.get("fillStyle")&&(t.fillStyle=this.get("fillStyle"),t.fill()),this.get("strokeStyle")&&(t.lineWidth=this.get("lineWidth"),t.strokeStyle=this.get("strokeStyle"),t.stroke()),t.restore()):this.getContainer().draw()},capture:function(t,e){var n,r,i;return e.beginPath(),i=this.get("rotate")||0,n=this.center(),e.save(),e.translate(n.x,n.y),e.rotate(i*Math.PI/180),e.translate(-n.x,-n.y),this.capture_shape(e),this.get("lineWidth")&&(e.lineWidth=this.get("lineWidth")+10),r=!!this.get("strokeStyle")&&e.isPointInStroke(t.x,t.y)||!!this.get("fillStyle")&&e.isPointInPath(t.x,t.y),e.restore(),r?this:null}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i,o={}.hasOwnProperty;r=[n(39)],i=function(t){"use strict";var e;return e={config:function(t){return t?this.configs[t]:this.configs},configure:function(t,e){var n,r,i;if(!t)return this;if(arguments.length>1&&"string"==typeof arguments[0])return r={},r[t]=e,this.configure(r);this.configs||(this.configs={}),console.log("configure",t),r=t,n={};for(t in r)o.call(r,t)&&(e=r[t],i=this.property_spec[t],i&&(this.configs[t]=e,n[t]=i.transform?i.transform(e):e));return this.set(n),this},silentSet:function(e,n){var r;return e?arguments.length>1&&"string"==typeof arguments[0]?(r={},r[e]=n,this.silentSet(r)):(this.attrs||(this.attrs={}),r=e,t.assign(this.attrs,r),this):this},set:function(e,n){var r,i,s,a;if(!e)return this;if(arguments.length>1&&"string"==typeof arguments[0])return i={},i[e]=n,this.set(i);this.attrs||(this.attrs={}),i=e,r={},s=t.clone(this.attrs),t.assign(this.attrs,i),a=this.attrs;for(e in a)o.call(a,e)&&(n=a[e],n!==s[e]?r[e]=n:delete s[e]);return 0!==Object.keys(r).length&&this.trigger("change",this,s,r),this},get:function(t){return this.attrs[t]},getAll:function(){return this.attrs?t.clone(this.attrs):{}}}}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={initialize:function(t,e){var n,r,i,o;this.configs=t,this.property_spec=e,this.attrs={},o=this.property_spec;for(n in o)r=o[n],i=null,this.configs.hasOwnProperty(n)?i=this.configs[n]:r.hasOwnProperty("default")&&(i=r["default"]),this.attrs[n]=i;return this},dispose:function(){}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i;r=[n(39),n(63)],i=function(t,e){"use strict";var n,r,i,o,s,a,c,u;n={on:function(t,e,n){var r;return o(this,"on",t,[e,n])&&e?(this._listeners||(this._listeners={}),r=this._listeners[t]||(this._listeners[t]=[]),r.push({callback:e,context:n,ctx:n||this}),this):this},once:function(e,n,r){var i,s;return o(this,"once",e,[n,r])&&n?(s=this,i=t.once(function(){return s.off(e,i),n.apply(this,arguments)}),i._callback=n,this.on(e,i,r)):this},off:function(t,e,n){var r,i,s,a,c,u,p,h,l,f;if(!this._listeners||!o(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._listeners=void 0,this;for(c=t?[t]:Object.keys(this._listeners),s=p=0,l=c.length;l>p;s=++p)if(t=c[s],i=this._listeners[t]){if(this._listeners[t]=u=[],e||n)for(a=h=0,f=i.length;f>h;a=++h)r=i[a],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&u.push(r);u.length||delete this._listeners[t]}return this},delegate_on:function(t){return this._delegators||(this._delegators=new e.List),this._delegators.append(t),this},delegate_off:function(t){return this._delegators?(this._delegators.remove(t),this):this},delegate:function(){var t,e,n;return this._delegators&&this._delegators.size()>0&&r(this._delegators,arguments),this._listeners?(t=arguments[arguments.length-1],t.deliverer=this,e=this._listeners[t.name],n=this._listeners.all,e&&u(e,arguments),n&&u(n,arguments),this):this},trigger:function(t){var e,n,i;return e=[].slice.call(arguments,1),e.push({origin:this,name:t,deliverer:this}),this._delegators&&this._delegators.size()>0&&r(this._delegators,e),this._listeners&&o(this,"trigger",t,e)?(n=this._listeners[t],i=this._listeners.all,n&&u(n,e),i&&u(i,e),this):this},stopListening:function(e,n,r){var i,o,s;if(o=this._listeningTo,!o)return this;s=!n&&!r,r||"object"!=typeof n||(r=this),e&&((o={})[e._listenId]=e);for(i in o)e=o[i],e.off(n,r,this),(s||t.isEmpty(e._events))&&delete this._listeningTo[i];return this}},i=/\s+/,o=function(t,e,n,r){var o,s,a,c,u;if(!n)return!0;if("object"==typeof n){for(o in n)a=n[o],t[e].apply(t,[o,a].concat(r));return!1}if(i.test(n)){for(s=n.split(i),c=0,u=s.length;u>c;c++)a=s[c],t[e].apply(t,[a].concat(r));return!1}return!0},u=function(t,e){var n,r,i,o;for(o=[],r=0,i=t.length;i>r;r++)n=t[r],o.push(n.callback.apply(n.ctx,e));return o},r=function(t,e){return t.forEach(function(t){return n.delegate.apply(t,e)})},a={listenTo:"on",listenToOnce:"once"};for(c in a)s=a[c],n[c]=function(e,n,r){var i,o;return o=this._listeningTo||(this._listeningTo={}),i=e._listenId||(e._listenId=t.uniqueId("l")),o[i]=e,r||"object"!=typeof n||(r=this),e[s](n,r,this),this};return n}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n,r;return t=function(t,e,n,r){return t.trigger("add",e,n,r)},e=function(t,e,n,r){return t.trigger("added",e,n,r)},n=function(t,e,n){return t.trigger("remove",e,n)},r=function(t,e,n){return t.trigger("removed",e,n)},{add:t,added:e,remove:n,removed:r}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={path:{type:"array"}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={font:{type:"string","default":"normal 10px verdana"}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={x1:{type:"number","default":0},y1:{type:"number","default":0},x2:{type:"number","default":100},y2:{type:"number","default":100}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t=function(t,e,n){var r,i,o,s,a,c,u;if(e>2)return t;if("number"==typeof e||(e=0),"boolean"==typeof n||(n=!1),a=!1,u=function(t){var e,n,r,i;for(n="",e=r=0,i=t-1;i>=0?i>=r:r>=i;e=i>=0?++r:--r)return n+="  "},c="","undefined"==typeof t)c+="undefined";else if("boolean"==typeof t||"number"==typeof t)c+=t.toString();else if("string"==typeof t)c+='"'+t+'"';else if(null===t)c+="null";else if(t instanceof Array)if(t.length>0){n&&(a=!0),r="";for(o in t)i=t[o],r+=pp(i,e+1)+",\n"+u(e+1);r=r.replace(/,\n\s*$/,"").replace(/^\s*/,""),c+="[ "+r+"\n"+u(e)+"]"}else c+="[]";else if("object"==typeof t)if(Object.keys(t).length>0){n&&(a=!0),r="";for(s in t)r+=u(e+1)+s.toString()+": "+pp(t[s],e+2,!0)+",\n";r=r.replace(/,\n\s*$/,"").replace(/^\s*/,""),c+="{ "+r+"\n"+u(e)+"}"}else c+="{}";else c+=t.toString();return(a?"\n"+u(e):"")+c}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(49),n(43),n(45)],i=function(t,e,n,r){"use strict";var i,o;return o=function(t,e,n){var r,i,s;return i=t.getContainer(),i.canvas||o(i,e,!0),n?(s=t.get("rotate")||0,r=t.center(),e.translate(r.x,r.y),e.rotate(s*Math.PI/180),e.translate(-r.x,-r.y),e.translate(t.get("x"),t.get("y"))):void 0},i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.include(e),i.prototype.center=function(){return{x:this.get("x"),y:this.get("y")}},i.prototype.shape=function(t){var e,n,r,i;return i=this.getContainer().target,t.save(),o(i,t),e=i.center(),r=i.get("rotate"),t.translate(e.x,e.y),t.rotate(r*Math.PI/180),t.translate(-e.x,-e.y),n=this.get("r"),t.rect(this.get("x")-n,this.get("y")-n,2*n,2*n),t.restore()},i.prototype.event_map=function(){return[]},i.spec={type:"handle",source:"core:handle.SplitHandle",containable:!1,description:"Path Splitter Handle",dependencies:{},properties:[n,r,{x:{type:"number"},y:{type:"number"},r:{type:"number"},index:{type:"string"}}]},i}(t)}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(e){e.exports=t},function(t,e,n){var r,i,o={}.hasOwnProperty;r=[n(39),n(32)],i=function(t,e){"use strict";var n,r,i;return r=function(t,n,r,i,s){var a,c,u,p,h;h=[];for(p in r)o.call(r,p)&&(a=r[p],e.match(p,i.origin,n,t)&&h.push(function(){var t;t=[];for(c in a)o.call(a,c)&&(u=a[c],c===i.name&&(i.listener=n,t.push(u.apply(this,s))));return t}.call(this)));return h},i=function(){var t,e,n,i,o,s,a,c;for(t=arguments,e=t[t.length-1],n=this.eventPump,a=n.listeners,c=[],o=0,s=a.length;s>o;o++)i=a[o],c.push(r.call(this.context,n.deliverer,i.listener,i.clonedHandlers,e,t));return c},n=function(){function t(t){this.setDeliverer(t),this.listeners=[]}return t.prototype.setDeliverer=function(t){return this.deliverer=t},t.prototype.start=function(t){return this.deliverer.on("all",i,{context:t||null,eventPump:this})},t.prototype.stop=function(){return this.deliverer.off("all",i)},t.prototype.on=function(t,e){var n,r,i,o,s,a,c,u;for(n=_.clone(e),o=Object.keys(n),c=0,u=o.length;u>c;c++)i=o[c],0===i.indexOf("?")&&(r=n[i],a=i.substr(1),s=t.get(a),delete n[i],s?n[s]=r:console.log("EventPump#on","variable "+i+" is not evaluated on listener"));return this.listeners.push({listener:t,handlers:e,clonedHandlers:n})},t.prototype.off=function(t,e){var n,r,i,o,s,a;for(s=this.listeners,a=[],n=i=0,o=s.length;o>i;n=++i)r=s[n],a.push(r.listener!==t||e&&r.handlers!==e?void 0:this.listeners.splice(n,1));return a},t.prototype.clear=function(){return this.listeners=[]},t.prototype.dispose=function(){return this.stop(),this.clear()},t}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(62)],i=function(t){var e,n,r;return r=function(){},n=function(n){var r,i;return e.dragging=!1,i=e.target,i&&(r=i.getStage().point(n),t.dragend(e.target,n,r)),delete e.target,e.cleanup()},e={draggable:!1,dragging:!1,target:null,drag_end_target:null,start_point:null,last_point:null,cutoff:4,cleanup:function(){return this.target=null,this.drag_end_target=null,this.start_point=null,this.last_point=null,this.dragging=!1,this.draggable=!1},drag:function(e,n,r){var i;if(this.start_point||(this.start_point=r),!this.dragging&&e.get("draggable")){if(void 0!==n.touches&&(i=Math.max(Math.abs(r.x-this.start_point.x),Math.abs(r.y-this.start_point.y)),i<this.cutoff))return;this.dragging=!0,this.target=e,t.dragstart(e,n,this.start_point)}return this.dragging?(this.last_point=r,t.drag(this.target,n,r)):void 0}},document.addEventListener("mouseup",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("mouseup",n,!1),document.addEventListener("touchend",n,!1),e}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t,e,n){var r,i;r=[n(39)],i=function(t){"use strict";var e,n,r;return r=function(t,e,n,r){var i,o;return r||(o=t.getStage(),r=o.point(n)),i={origin:n,type:e,target:t,offsetX:r.x,offsetY:r.y},t.trigger(i.type,i)},e=function(t){return function(e,n,i){return r(e,t,n,i)}},n=["mousemove","mousedown","mouseup","click","doubleclick","contextmenu","mouseover","mouseout","dragstart","drag","dragend","touchstart","touchmove","touchend","longtouch","tap","doubletap"],t.reduce(n,function(t,n){return t[n]=e(n),t},{})}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n,r={}.hasOwnProperty;e=[],n=function(){"use strict";var t,e,n,i,o;return i={insertAt:function(t,e){return this.__collection__?(t=this.__collection__.indexOf(e),-1===this.__collection__.indexOf(e)&&this.__collection__.splice(t,0,e),this):this},append:function(t){return this.__collection__||(this.__collection__=[]),-1===this.__collection__.indexOf(t)&&this.__collection__.push(t),this},prepend:function(t){return this.__collection__||(this.__collection__=[]),-1===this.__collection__.indexOf(t)&&this.__collection__.unshift(t),this},remove:function(t){var e;return this.__collection__?(e=this.__collection__.indexOf(t),e>-1&&this.__collection__.splice(e,1),this):this},getAt:function(t){return this.__collection__?this.__collection__[t]:void 0},forEach:function(t,e){return this.__collection__?this.__collection__.forEach(t,e):this},indexOf:function(t){return(this.__collection__||[]).indexOf(t)},size:function(){return(this.__collection__||[]).length},clear:function(){return this.__collection__=[]},moveForward:function(t){var e;return e=this.indexOf(t),-1!==e&&0!==e?(this.__collection__[e]=this.__collection__[e-1],this.__collection__[e-1]=t):void 0},moveBackward:function(t){var e;return e=this.indexOf(t),-1!==e&&e!==this.size()-1?(this.__collection__[e]=this.__collection__[e+1],this.__collection__[e+1]=t):void 0},moveToHead:function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&0!==n?(e=this.__collection__.splice(0,n),r=this.__collection__.splice(1),this.__collection__=this.__collection__.concat(e,r)):void 0},moveToTail:function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&n!==this.size()-1?(e=this.__collection__.splice(0,n),r=this.__collection__.splice(1),this.__collection__=e.concat(r,this.__collection__)):void 0}},o={push:function(){throw new Error("Not Implemented Yet")},pop:function(){throw new Error("Not Implemented Yet")}},e=function(){},e.prototype=i,n=function(){},n.prototype=o,t={List:e,Stack:n,withList:function(){var t,e,n;n=[];for(t in i)r.call(i,t)&&(e=i[t],n.push(this[t]=e));return n},withStack:function(){var t,e,n;n=[];for(t in o)r.call(o,t)&&(e=o[t],n.push(this[t]=e));return n}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,i;r=[n(39)],i=function(t){"use strict";var e;return e=function(){function e(e){this.params=t.clone(e)}return e.prototype.execute=function(){},e.prototype.unexecute=function(){},e}()}.apply(null,r),!(void 0!==i&&(t.exports=i))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n,r,i,o;return o='<ul id="context-menu" class="things-context-menu"> <li><a href="http://cooking.hatiolab.com/">Cooking</a></li> <li><a href="http://www.naver.com">Naver</a></li> </ul>',t=document.createElement("div"),t.style.position="absolute",t.style.display="inline-block",t.style.zIndex=1e3,document.body.appendChild(t),t.innerHTML=o,e=document.getElementById("context-menu"),n=function(){return document.removeEventListener("click",n),document.removeEventListener("touchstart",n),setTimeout(r,100)},i=function(r){return t.style.top=r.y+"px",t.style.left=r.x+"px",e.style.display="block",document.addEventListener("click",n),document.addEventListener("touchstart",n)},r=function(){return e.style.display="none"},{show:i,hide:r}}.apply(null,e),!(void 0!==n&&(t.exports=n))}])});