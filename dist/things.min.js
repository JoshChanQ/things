/*! Things v0.0.4 | (c) Hatio, Lab. | MIT License */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("_")):"function"==typeof define&&define.amd?define(["_"],e):"object"==typeof exports?exports.things=e(require("_")):t.things=e(t._)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r,o;r=[n(1),n(7),n(8),n(2),n(3),n(4),n(5),n(6),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29)],o=function(t,e,n,r,o,i,s,a,u,c,h,p,l,f,d,g,y,_,v,m,x,w,b,k,P,M,O,E,S){"use strict";var T;return T=[],{create:function(e){var n;return n=new t(e).getStage(),T.push(n),n},destroy:function(t){var e;return e=T.indexOf(t),e>-1&&T.splice(e,1),t.dispose()},stages:function(){return T},Component:e,Container:n,Animation:a,shape:{Barcode:u,Circle:c,Ellipse:h,ImageBox:p,Path:l,Rect:f,Ruler:d,Shape:s,Text:g,Line:y},layer:{DebugLayer:_,Layer:o,MagnifyLayer:v,RulerLayer:m,SelectionLayer:x,SlideLayer:w,WidgetLayer:b},group:{Group:i},handle:{BoundHandle:k,CircleHandle:P,Handle:M,P2PHandle:O,PathHandle:E,RotationHandle:S},stage:{Stage:r}}}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(39),n(30),n(2),n(7),n(31),n(32),n(33),n(34),n(35),n(40),n(41)],o=function(t,e,n,r,o,i,s,a,u,c,h){"use strict";var p;return r.include({setController:function(t){return this.controller=t},getController:function(){return this.controller},getStage:function(){return this.controller.getStage()},setSpec:function(t){return this.spec=t},getSpec:function(){return this.spec},build:function(t,e){return this.controller.build(t,e||this)},require:function(t){if(!this.controller)throw new Error("controller not initialized");return this.controller.require(t)},select:function(t,e){if(!this.controller)throw new Error("controller not initialized");return this.controller.select(t,e)},debug:function(t,e){return this.require("debug-layer").debug(t,e)}}),p=function(){function e(e){this.options=t.clone(e),this.exports={},this.exportsManager=new u(this),this.commandManager=new c,this.componentRegistry=new o,this.componentRegistry.setRegisterCallback(function(t){return this.exportsManager["import"](t.type,t.exports)},this),this.componentRegistry.setUnregisterCallback(function(t){return this.exportsManager.remove(t.type)},this),this.eventEngine=new a,this.componentFactory=new s(this.componentRegistry,this),this.componentRegistry.register("stage",n),this.stage=this.componentFactory.create("stage",e),this.eventEngine.setRoot(this.stage),this.eventEngine.add(this,h,this)}return e.prototype.setStage=function(t){return this.stage=t},e.prototype.getStage=function(){return this.stage},e.prototype.build=function(t,e){return this.componentFactory.build(t,e)},e.prototype.select=function(t,e){return i.select(t,e||this.stage)},e.prototype["import"]=function(t,e,n){return this.exportsManager["import"](t,e,n)},e.prototype.require=function(t){return this.exportsManager.require(t)},e.prototype.register=function(t,e){return this.componentRegistry.register(t,e)},e.prototype.change=function(t){var e,n,r,o,i;i=[];for(r in t)o=t[r],n=this.select(r),i.push(function(){var t,i,s;for(s=[],t=0,i=n.length;i>t;t++)e=n[t],console.log(r,e),s.push(e.set(o));return s}());return i},e.prototype.dispose=function(){return this.componentFactory.dispose(),this.commandManager.dispose(),this.eventEngine.dispose(),this.componentRegistry.dispose(),this.exportsManager.dispose()},e}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(30),n(8),n(43),n(36),n(37)],o=function(t,e,n,r,o){"use strict";var i;return i=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,e),i.prototype.draw=function(){return this.forEach(function(t){return t.draw})},i.prototype.init=function(){var e,n,i;return e=this.get("container"),this.client_container=e instanceof HTMLElement?e:document.getElementById(this.get("container")),this.client_container.innerHTML="",this.html_container=document.createElement("div"),this.html_container.style.position="relative",this.html_container.style.display="inline-block",i=this.get("w"),n=this.get("h"),this.html_container.style.width=void 0===i||null===i?"100%":i+"px",this.html_container.style.height=void 0===n||null===n?"100%":n+"px",this.client_container.appendChild(this.html_container),t.mobile||(this.mouseEventEngine=new r(this)),this.touchEventEngine=new o(this)},i.prototype.dispose=function(){return this.client_container.removeChild(this.html_container),this.controller.dispose(),this.touchEventEngine.dispose(),this.mouseEventEngine?this.mouseEventEngine.dispose():void 0},i.prototype.capture=function(t){var e,n,r,o,i;if(this.size()>0)for(r=o=i=this.size()-1;0>=i?0>=o:o>=0;r=0>=i?++o:--o)if(n=this.getAt(r),e=n.capture(t))return e;return this},i.prototype.position=function(){return this.html_container.getBoundingClientRect?this.html_container.getBoundingClientRect():{top:0,left:0}},i.prototype.point=function(e){var n,r,o,i,s,a;return e?(o=this.position(),s=null,a=null,void 0!==e.touches?e.touches.length>0&&(i=e.touches[0],s=i.clientX-o.left,a=i.clientY-o.top):(n=0,r=0,"CANVAS"===e.target.tagName&&(n=e.target.offsetLeft,r=e.target.offsetTop),void 0!==e.offsetX?(s=e.offsetX+n,a=e.offsetY+r):"mozilla"===t.UA.browser?(s=e.layerX+n,a=e.layerY+r):void 0!==e.clientX&&o&&(s=e.clientX-o.left+n,a=e.clientY-o.top+r)),null!==s&&null!==a&&(this.point_pos={x:s,y:a}),this.point_pos):this.point_pos},i.prototype.register=function(t,e){return this.controller.register(t,e)},i.prototype.model=function(t){var e,n,r;if(t.dependencies){r=t.dependencies;for(n in r)e=r[n],this.register(n,e)}return this.forEach(function(e){return e.model?e.model(t):void 0})},i.prototype.change=function(t){return this.controller.change(t)},i.prototype.objectify=function(){var t,e;return t=[],this.forEach(function(e){return t.push(e.objectify())}),e={},this.controller.componentRegistry.forEach(function(t,n){return console.log(t,n),e[t]=n.spec.source},this),console.log(e),{dependencies:e,components:t,attrs:{w:this.get("w"),h:this.get("h")}}},i.spec={type:"stage",source:"core:stage.Stage",containable:!0,container_type:"stage",description:"Stage",dependencies:{},properties:[n]},i}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(6),n(8),n(44),n(42)],o=function(t,e,n,r){"use strict";var o,i,a,u;return u=[],i=new t(function(){var t,e;if(0===u.length)return i.stop();for(e=[];t=u.shift();)e.push(t._draw());return e}),a=function(t){return-1<u.indexOf(t)?void 0:(u.push(t),1===u.length?i.start():void 0)},o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.clearCanvas=function(){return this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype._draw=function(){var t,e,n;return t=this.canvas.getContext("2d"),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.save(),e=this.get("offset-x"),n=this.get("offset-y"),t.translate(e,n),this.forEach(function(e){return e.draw(t)}),t.restore()},e.prototype.draw=function(){return a(this)},e.prototype.shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},e.prototype.capture=function(t){var e,n,r,o,i,s,a;if(r=this.canvas.getContext("2d"),r.beginPath(),i={x:t.x-this.get("offset-x")-this.get("x"),y:t.y-this.get("offset-y")-this.get("y")},this.shape(r),this.size()>0)for(o=s=a=this.size()-1;0>=a?0>=s:s>=0;o=0>=a?++s:--s)if(n=this.getAt(o),e=n.capture(i,r))return e;return null},e.prototype.init=function(){var t,e,n,r,o;return this.html_container=this.controller.getStage().html_container,this.canvas=document.createElement("canvas"),t=this.controller.options,r=this.get("x")||0,o=this.get("y")||0,n=this.get("w")||t.w&&t.w-r||this.html_container.offsetWidth-r,e=this.get("h")||t.h&&t.h-o||this.html_container.offsetHeight-o,this.set({x:r,y:o,w:n,h:e}),this.canvas.style.display=this.get("visible")!==!1?"block":"none",this.canvas.style.padding=0,this.canvas.style.margin=0,this.canvas.style.border=0,this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.canvas.style.top=o+"px",this.canvas.style.left=r+"px",this.canvas.setAttribute("width",n),this.canvas.setAttribute("height",e),this.html_container.appendChild(this.canvas)},e.prototype.event_map=function(){return r},e.prototype.dispose=function(){return this.html_container.removeChild(this.canvas),this.controller=null},e.spec={type:"layer",source:"core:layer.Layer",containable:!0,container_type:"layer",description:"Abstract Layer",dependencies:{},properties:[n]},e}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(8),n(47),n(48),n(45),n(46)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.include(e),i.include(n),i.prototype.handles=function(){return["bound-handle","rotation-handle"]},i.prototype.positions=function(){return[["x","y"]]},i.prototype.bound=function(){return{x:this.get("x"),y:this.get("y"),w:this.get("w"),h:this.get("h")}},i.prototype.move=function(t){var e,n,r,o,i,s;if(e=t.delta,!_.isEmpty(e)){for(r={},s=this.positions(),o=0,i=s.length;i>o;o++)n=s[o],e.x&&(r[n[0]]=Math.round(this.get(n[0])+e.x)),e.y&&(r[n[1]]=Math.round(this.get(n[1])+e.y));return this.set(r)}},i.prototype.event_map=null,i.spec={type:"group",source:"core:group.Group",containable:!0,container_type:"group",description:"Group",dependencies:{},properties:[r,o,{clip:{type:"boolean","default":!0}}]},i}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(7),n(47),n(49),n(50),n(45),n(46)],o=function(t,e,n,r,o,i,a){"use strict";var u;return u=function(e){function u(){return u.__super__.constructor.apply(this,arguments)}return s(u,e),u.include(n),u.include(r),u.include(o),u.prototype.handles=function(){return["bound-handle"]},u.prototype.positions=function(){return[["x","y"]]},u.prototype.move=function(e){var n,r,o,i,s,a,u,c,h;if(n=e.delta,!t.isEmpty(n)){if(s={},i=this.positions(),i instanceof Array)for(a=0,c=i.length;c>a;a++)r=i[a],n.x&&(s[r[0]]=Math.round(this.get(r[0])+n.x)),n.y&&(s[r[1]]=Math.round(this.get(r[1])+n.y));else{for(o=t.clone(this.get(i)),u=0,h=o.length;h>u;u++)r=o[u],n.x&&(r[0]+=Math.round(n.x)),n.y&&(r[1]+=Math.round(n.y));s[i]=o}return this.set(s)}},u.prototype.event_map=function(){return null},u.spec={type:"shape",source:"core:shape.Shape",containable:!1,description:"Abstract Shape",dependencies:{},properties:[i,a]},u}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n,r,o,i,s,a,u,c,h,p;return s=[],r=0,o=!1,n=function(t){return s.push(t),a()},c=function(t){var e,n,r,o,i,a;for(n=t.id,a=[],r=o=0,i=s.length;i>o;r=++o){if(e=s[r],e.id===n){s.splice(r,1);break}a.push(void 0)}return a},u=function(){return window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return(new Date).getTime()}}(),e=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)}}(),h=function(){return e.apply(window,arguments)},p=function(){var t,e,n,r,o;for(o=[],n=0,r=s.length;r>n;n++)t=s[n],e=t.func,t.updateFrameObject(u()),o.push(e?e.call(t,t.frame):void 0);return o},i=function(){return s.length?(h(i),p()):o=!1},a=function(){return o?void 0:(o=!0,i())},t=function(){function t(t){this.func=t,this.id=r++,this.frame={time:0,timeDiff:0,lastTime:u()}}return t.prototype.isRunning=function(){var t,e,n;for(e=0,n=s.length;n>e;e++)if(t=s[e],t.id===this.id)return!0;return!1},t.prototype.start=function(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=u(),n(this)},t.prototype.stop=function(){return c(this)},t.prototype.updateFrameObject=function(t){return this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff},t}()}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(38),n(51),n(52),n(53),n(49)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function i(t,e){this.type=t,this.container=e}return s(i,t),i.include(e),i.include(n),i.include(r),i.include(o),i.prototype.getType=function(){return this.type},i.prototype.dispose=function(){return this.setContainer(null)},i.prototype.getContainer=function(){return this.container},i.prototype.setContainer=function(t){return t!==this.container?(this.container&&this.container.remove(this),this.container=t,this.container?this.container.add(this):void 0):void 0},i.prototype.moveAt=function(t){return this.getContainer()?this.container.moveChildAt(t,this):void 0},i.prototype.moveForward=function(){return this.getContainer()?this.container.moveChildForward(this):void 0},i.prototype.moveBackward=function(){return this.getContainer()?this.container.moveChildBackward(this):void 0},i.prototype.moveToFront=function(){return this.getContainer()?this.container.moveChildToFront(this):void 0},i.prototype.moveToBack=function(){return this.getContainer()?this.container.moveChildToBack(this):void 0},i}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(7),n(54)],o=function(t,e,n){"use strict";var r,o,i,a,u,c,h,p,l,f,d,g,y,_,v,m;return o=[],a=function(t,r){var o,i,s;if(o=r instanceof e,o&&(s=r.getContainer())){if(t===s)return;v(t,r)}return i=t.__components__.push(r)-1,o&&r.setContainer(t),n.add(t,t,r,i),o?(r.delegate_on(t),n.added(r,t,r,i)):void 0},v=function(t,r){var o,i;return o=r instanceof e,i=t.__components__.indexOf(r),-1!==i&&(i>-1&&t.__components__.splice(i,1),o&&r.setContainer(null),n.remove(t,t,r),r instanceof e)?(n.removed(r,t,r),r.delegate_off(t)):void 0},i=function(t){var e,n,r;if(this.__components__||(this.__components__=[]),!(t instanceof Array))return i.call(this,[t]);for(n=0,r=t.length;r>n;n++)e=t[n],a(this,e);return this},y=function(t){var e,n,r;if(!(t instanceof Array))return y.call(this,[t]);if(this.__components__){for(n=0,r=t.length;r>n;n++)e=t[n],v(this,e);return this}},_=function(){return this.remove(t.clone(this.__components__))},c=function(t){return this.__components__?this.__components__[t]:void 0},u=function(t,e){return this.__components__?this.__components__.forEach(t,e):void 0},h=function(t){return(this.__components__||o).indexOf(t)},m=function(){return(this.__components__||o).length},p=function(t,e){var n,r,o;return r=this.indexOf(e),-1!==r?(n=this.__components__.splice(0,r),o=this.__components__.splice(1),this.__components__=n.concat(o),t=Math.max(0,t),t=Math.min(t,this.__components__.length),n=this.__components__.splice(0,t),this.__components__=n.concat(e,this.__components__)):void 0},f=function(t){var e;return e=this.indexOf(t),-1!==e&&e!==this.size()-1?(this.__components__[e]=this.__components__[e+1],this.__components__[e+1]=t):void 0},l=function(t){var e;return e=this.indexOf(t),-1!==e&&0!==e?(this.__components__[e]=this.__components__[e-1],this.__components__[e-1]=t):void 0},g=function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&n!==this.size()-1?(e=this.__components__.splice(0,n),r=this.__components__.splice(1),this.__components__=e.concat(r,this.__components__)):void 0},d=function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&0!==n?(e=this.__components__.splice(0,n),r=this.__components__.splice(1),this.__components__=this.__components__.concat(e,r)):void 0},r=function(e){function n(t){n.__super__.constructor.call(this,t)}return s(n,e),n.prototype.dispose=function(){var e,r,o,i;if(this.__components__){for(e=t.clone(this.__components__),o=0,i=e.length;i>o;o++)r=e[o],r.dispose();this.__components__=null}return n.__super__.dispose.call(this)},n.prototype.add=i,n.prototype.remove=y,n.prototype.removeAll=_,n.prototype.size=m,n.prototype.getAt=c,n.prototype.indexOf=h,n.prototype.forEach=u,n.prototype.moveChildAt=p,n.prototype.moveChildForward=f,n.prototype.moveChildBackward=l,n.prototype.moveChildToFront=g,n.prototype.moveChildToBack=d,n}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(24),n(29),n(45),n(46)],o=function(t,e,n,r,o,i){"use strict";var a;return a=function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return s(a,e),a.prototype.capture_shape=function(t){return t.rect(this.get("x"),this.get("y"),this.barcode.width,this.barcode.height)},a.prototype.onadded=function(){var t;return this.barcode=new Image,t=this,this.barcode.onload=function(){return t.draw()},this.barcode.src=this.makeurl()},a.prototype.shape=function(t){if(this.barcode)try{return this.get("w")?t.drawImage(this.barcode,this.get("x"),this.get("y"),this.get("w"),this.get("h")):t.drawImage(this.barcode,this.get("x"),this.get("y"))}catch(e){}},a.prototype.bound=function(){return{x:this.get("x"),y:this.get("y"),w:this.get("w")||this.barcode.width,h:this.get("h")||this.barcode.height}},a.prototype.makeurl=function(){var t;return t="http://barcode.hatiolab.com:81/?",t+="text="+window.escape(this.get("text")),t+="&bcid="+(this.get("symbol")||"code128"),t+="&wscale="+(this.get("scale-w")||2),t+="&hscale="+(this.get("scale-h")||2),t+="&rotate="+(this.get("rotation")||"N"),this.get("alttext")?t+="&alttext="+window.escape(this.get("alttext")):this.get("includetext")&&(t+="&alttext="+window.escape(this.get("text"))),this.get("barcolor")&&"#000000"!==this.get("barcolor")&&(t+="&barcolor="+window.escape(this.get("barcolor"))),this.get("backgroundcolor")&&"#FFFFFF"!==this.get("backgroundcolor")&&(t+="&backgroundcolor="+window.escape(this.get("backgroundcolor"))),t},a.prototype.handles=function(){return["bound-handle","rotation-handle"]},a.prototype.event_map=function(){var e;return e={"(self)":{"(self)":{change:function(e,n,r){var o;return o=t.pick(r,["symbol","text","alttext","scale-h","scale-w","rotation","includetext","barcolor","backgroundcolor"]),t.isEmpty(o)?void 0:this.barcode.src=this.makeurl()}}}}},a.spec={type:"barcode",source:"core:shape.Barcode",containable:!1,description:"Barcode",dependencies:{"bound-handle":n,"rotation-handle":r},properties:[o,i,{symbol:{type:"string"},text:{type:"string"},alttext:{type:"string"},"scale-h":{type:"number"},"scale-w":{type:"number"},rotation:{type:"sring"},includetext:{type:"boolean"},barcolor:{type:"string"},backgroundcolor:{type:"string"}}]},a}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(25),n(46),n(55)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.center=function(){return{x:this.get("cx"),y:this.get("cy")}},e.prototype.shape=function(t){return t.arc(this.get("cx"),this.get("cy"),this.get("r"),0,2*Math.PI,!1)},e.prototype.handles=function(){return["circle-handle"]},e.prototype.positions=function(){return[["cx","cy"]]},e.prototype.dockPoints=function(){var t,e,n,r,o,i;for(e=this.get("cx"),n=this.get("cy"),o=this.get("r"),r=[],t=i=0;359>=i;t=i+=45)r.push([e+Math.cos(t*Math.PI/180)*o,n-Math.sin(t*Math.PI/180)*o]);return r},e.spec={type:"circle",source:"core:shape.Circle",containable:!1,description:"Circle",dependencies:{"circle-handle":n},properties:[o,r]},e}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(45),n(46)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype.shape=function(t){var e,n,r,o,i,s,a;return s=this.get("x"),a=this.get("y"),i=this.get("w"),r=this.get("h"),e=s+i/2,n=a+r/2,o=i/2,t.save(),t.scale(1,r/i),t.arc(e,n*i/r,o,0,2*Math.PI,!1),t.restore()},i.prototype.handles=function(){return["bound-handle","rotation-handle"]},i.spec={type:"ellipse",source:"core:shape.Ellipse",containable:!1,description:"Ellipse",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[r,o]},i}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(45),n(46)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype.capture_shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w")||this.image.width,this.get("h")||this.image.height)},i.prototype.onadded=function(){var t;return this.image=new Image,t=this,this.image.onload=function(){return t.draw()},this.image.src=this.get("src")},i.prototype.shape=function(t){return this.image?t.drawImage(this.image,this.get("x"),this.get("y"),this.get("w")||this.image.width,this.get("h")||this.image.height):void 0},i.prototype.bound=function(){return{x:this.get("x"),y:this.get("y"),w:this.get("w")||this.image.width,h:this.get("h")||this.image.height}},i.prototype.handles=function(){return["bound-handle","rotation-handle"]},i.prototype.event_map=function(){var t;return t={"(self)":{"(self)":{change:function(t,e,n){return n.hasOwnProperty("src")?this.image.src=n.src:void 0}}}}},i.spec={type:"image",source:"core:shape.ImageBox",containable:!1,description:"ImageBox",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[r,o,{src:{type:"string"}}]},i}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(28),n(56),n(46)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.center=function(){var t,e,n,r,o,i,s;for(e=this.get("path"),n=e.length,r=0,o=0,i=0,s=e.length;s>i;i++)t=e[i],r+=t[0],o+=t[1];return{x:r/n,y:o/n}},e.prototype.shape=function(t){var e,n,r,o,i,s;for(n=this.get("path"),r=n.length,o=n[0],t.moveTo(o[0],o[1]),s=[],e=i=0;r>=0?r>i:i>r;e=r>=0?++i:--i)s.push(t.lineTo(n[e][0],n[e][1]));return s},e.prototype.handles=function(){return["path-handle"]},e.prototype.positions=function(){return"path"},e.prototype.dockPoints=function(){return this.get("path")},e.prototype.event_map=function(){},e.spec={type:"path",source:"core:shape.Path",containable:!1,description:"Path",dependencies:{"path-handle":n},properties:[r,o]},e}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(45),n(46)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype.shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},i.prototype.handles=function(){return["bound-handle","rotation-handle"]},i.spec={type:"rect",source:"core:shape.Rect",containable:!1,description:"Rectangle",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[r,o]},i}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(24),n(29),n(45),n(46),n(57)],o=function(t,e,n,r,o,i){"use strict";var a,u;return a=3.779527559,u=function(t){function u(){return u.__super__.constructor.apply(this,arguments)}return s(u,t),u.prototype.capture_shape=function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},u.prototype.shape=function(t){var e;return e=this.bound(),t.rect(e.x,e.y,e.w,e.h),"vertical"!==this.get("direction")?this.drawHorizontal(t,e):this.drawVertical(t,e)},u.prototype.handles=function(){return["bound-handle","rotation-handle"]},u.prototype.drawHorizontal=function(t,e){var n,r,o,i,s,u,c,h,p,l,f,d,g,y,_,v,m,x,w,b,k;for(d=parseInt(this.get("zeropos")),l=e.x+d,i=e.x+this.get("margin")[0],s=e.x+e.w-this.get("margin")[1],n=e.y+e.h-15,r=e.y+e.h,p=e.w-d,h=Math.ceil(p/a),o=g=0,m=h-1;(m>=0?m>=g:g>=m)&&(f=l+o*a,!(f>s));o=m>=0?++g:--g)i>f||(o%10===0?(t.moveTo(f,n),t.lineTo(f,r)):o%5===0?(t.moveTo(f,n+8),t.lineTo(f,r)):(t.moveTo(f,n+11),t.lineTo(f,r)));for(c=d,u=Math.floor(c/a),o=y=1,x=u-1;(x>=1?x>=y:y>=x)&&(f=l-o*a,!(i>f));o=x>=1?++y:--y)f>s||(o%10===0?(t.moveTo(f,n),t.lineTo(f,r)):o%5===0?(t.moveTo(f,n+8),t.lineTo(f,r)):(t.moveTo(f,n+11),t.lineTo(f,r)));for(t.textAlign="left",t.textBaseline="bottom",o=_=0,w=h-1;w>=_&&(f=l+o*a,!(f>s));o=_+=10)i>f||t.fillText(""+o/10,f+2,n+10);for(k=[],o=v=10,b=u-1;b>=v&&(f=l-o*a,!(i>f));o=v+=10)f>s||k.push(t.fillText("-"+o/10,f+2,n+10));return k},u.prototype.drawVertical=function(t,e){var n,r,o,i,s,u,c,h,p,l,f,d,g,y,_,v,m,x,w,b,k;for(d=parseInt(this.get("zeropos")),l=e.y+d,s=e.y+this.get("margin")[0],i=e.y+e.h-this.get("margin")[1],n=e.x+e.w-15,r=e.x+e.w,h=e.h-d,p=Math.ceil(h/a),o=g=0,m=p-1;(m>=0?m>=g:g>=m)&&(f=l+o*a,!(f>i));o=m>=0?++g:--g)s>f||(o%10===0?(t.moveTo(n,f),t.lineTo(r,f)):o%5===0?(t.moveTo(n+8,f),t.lineTo(r,f)):(t.moveTo(n+11,f),t.lineTo(r,f)));for(u=d,c=Math.floor(u/a),o=y=1,x=c-1;x>=1?x>=y:y>=x;o=x>=1?++y:--y)if(f=l-o*a,!(f>i)){if(s>f)break;o%10===0?(t.moveTo(n,f),t.lineTo(r,f)):o%5===0?(t.moveTo(n+8,f),t.lineTo(r,f)):(t.moveTo(n+11,f),t.lineTo(r,f))}for(t.textAlign="right",t.textBaseline="top",o=_=0,w=p-1;w>=_&&(f=l+o*a,!(f>i));o=_+=10)s>f||t.fillText(""+o/10,n+10,f+2);for(k=[],o=v=10,b=c-1;b>=v&&(f=l-o*a,!(s>f));o=v+=10)f>i||k.push(t.fillText("-"+o/10,n+10,f+2));return k},u.spec={type:"ruler",source:"core:shape.Ruler",containable:!1,description:"Ruler",dependencies:{"bound-handle":e,"rotation-handle":n},properties:[r,o,i,{zeropos:{type:"number","default":0},direction:{type:"string","default":"horizontal"},margin:{type:"array","default":[0,0]}}]},u}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(5),n(45),n(46),n(57)],o=function(t,e,n,r){"use strict";var o;return o=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype._wrap=function(t,e,n,r,o,i){var s,a,u,c,h,p,l,f,d;for(l=e.split(" "),a="",s=f=0,d=l.length;d>f;s=++f)p=l[s],c=a+p+" ",u=t.measureText(c),h=u.width,h>o&&s>0?(t.fillText(a,n,r),a=p+" ",r+=i):a=c;return t.fillText(a,n,r)},o.prototype.shape=function(t){return this._wrap(t,this.get("text"),this.get("x"),this.get("y"),this.get("w"),10),t.font=this.get("font")},o.spec={type:"text",source:"core:shape.Text",containable:!1,description:"Text Box",dependencies:{},properties:[e,n,r,{text:{type:"string","default":""}}]},o}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(5),n(27),n(58),n(46)],o=function(t,e,n,r,o){"use strict";var i;return i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.center=function(){return{x:(this.get("x1")+this.get("x2"))/2,y:(this.get("y1")+this.get("y2"))/2}},e.prototype.shape=function(t){return t.moveTo(this.get("x1"),this.get("y1")),t.lineTo(this.get("x2"),this.get("y2"))},e.prototype.handles=function(){return["p2p-handle"]},e.prototype.positions=function(){return[["x1","y1"],["x2","y2"]]},e.prototype.dockPoints=function(){return[[this.get("x1"),this.get("y1")],[this.get("x2"),this.get("y2")]]},e.prototype.event_map=function(){},e.spec={type:"line",source:"core:shape.Line",containable:!1,description:"Direct Line",dependencies:{"p2p-handle":n},properties:[r,o]},e}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(44),n(16),n(59)],o=function(t,e,n,r){"use strict";var o,i;return i={debug:function(t,e){var n,o;return n=function(t){return function(){return t.debug_layer||(t.debug_layer?void 0:t.debug_layer=t.select("debug-layer")[0])}}(this),o=function(t){return function(){return t.debug_text||(t.debug_text?void 0:t.debug_text=t.select("text",n())[0])}}(this),o().set("text",t+":"+r(e)),n().draw()}},o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.spec={type:"debug-layer",source:"core:layer.DebugLayer",containable:!0,container_type:"layer",description:"Debug Layer",dependencies:{text:n},properties:[e],components:[{type:"text",name:"debug-text",attrs:{text:"",x:0,y:20,w:300,h:300,capturable:!1}}],exports:i},r}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(44),n(46),n(42),n(10)],o=function(t,e,n,r,o){"use strict";var i,a,u,c,h,p;return c={ondragstart:function(t){return this.handle_last_position={x:t.offsetX,y:t.offsetY}},ondrag:function(t){var e,n,r,o;return e={x:t.offsetX-this.handle_last_position.x,y:t.offsetY-this.handle_last_position.y},n=this.get("x")+e.x,r=this.get("y")+e.y,o={x:n,y:r},this.set(o),this.handle_last_position={x:t.offsetX,y:t.offsetY},this.draw()},ondragend:function(){return this.handle_last_position=null}},u={ondragstart:function(t){return this.edge_last_position={x:t.offsetX,y:t.offsetY},this.last_ratio=this.get("ratio")},ondrag:function(t){var e,n;return e=t.offsetY-this.edge_last_position.y,n=Math.min(Math.max(this.last_ratio+e/20,.5),4),this.set("ratio",n),this.draw()},ondragend:function(){return this.edge_last_position=null
}},p=function(){return this.draw()},h=function(t,e,n){return n.hasOwnProperty("x")&&(this.canvas.style.left=n.x+"px"),n.hasOwnProperty("y")&&(this.canvas.style.top=n.y+"px"),n.hasOwnProperty("r")?(this.set({w:2*n.r,h:2*n.r}),this.canvas.setAttribute("width",2*n.r),this.canvas.setAttribute("height",2*n.r)):void 0},i={"?target":{"(all)":{change:p}},"(self)":{"(self)":{change:h},"#magnify-handle":{dragstart:c.ondragstart,drag:c.ondrag,dragend:c.ondragend},"#magnify-edge":{dragstart:u.ondragstart,drag:u.ondrag,dragend:u.ondragend}}},a=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,t),n.prototype.onadded=function(){var t;return this.target=this.select(this.get("target"))[0],this.magnify_edge=this.select("#magnify-edge")[0],t=this.get("r"),this.set({resizable:!1,w:2*t,h:2*t,x:this.target.canvas.width/2-t,y:this.target.canvas.height/2-t}),this.canvas.setAttribute("width",2*t),this.canvas.setAttribute("height",2*t),this.magnify_edge.set({cx:t,cy:t,r:t-5})},n.prototype._draw=function(){var t,e,n,r,o,i,s,a,u,c,h,p,l,f,d,g,y,_,v;if(this.target)return this.clearCanvas(),t=this.canvas.getContext("2d"),t.save(),t.beginPath(),c=this.get("r"),h=this.get("ratio"),t.arc(c,c,c-1,0,2*Math.PI,!1),t.clip(),t.rect(0,0,2*c,2*c),this.get("fillStyle")&&(t.fillStyle=this.get("fillStyle"),t.fill()),f=this.get("x")-this.target.get("x")+c,d=this.get("y")-this.target.get("y")+c,l=Math.round(c/h),p=l,i=f-l,s=d-p,o=2*l,r=2*p,_=0,v=0,y=2*c,g=2*c,0>i&&(_+=Math.round(-i*h),y-=_,o-=-i,i=0),0>s&&(v+=Math.round(-s*h),g-=v,r-=-s,s=0),a=this.target.canvas.width,n=i+o-a,n>0&&(o-=n,y-=Math.round(n*h)),u=this.target.canvas.height,e=s+r-u,e>0&&(r-=e,g-=Math.round(e*h)),t.drawImage(this.target.canvas,i,s,o,r,_,v,y,g),t.restore(),this.forEach(function(e){return e.draw(t)})},n.prototype.event_map=function(){return[i,r]},n.spec={type:"magnify-layer",source:"core:layer.MagnifyLayer",containable:!0,container_type:"layer",description:"Magnify Layer",dependencies:{circle:o},properties:[e],components:[{type:"circle",attrs:{id:"magnify-edge",cx:100,cy:100,r:95,lineWidth:10,strokeStyle:"black",capturable:!0,draggable:!0}},{type:"circle",attrs:{id:"magnify-handle",cx:180,cy:180,r:16,lineWidth:8,strokeStyle:"black",fillStyle:"red",capturable:!0,draggable:!0}}]},n}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(15),n(44),n(42)],o=function(t,e,n,r){"use strict";var o;return o=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype.onadded=function(){var t;return this.target=this.select(this.get("target"))[0],t=this.select("ruler",this),this.hori=t[0],this.vert=t[1],this.hori.set({w:this.target.canvas.width,h:20,zeropos:this.target.get("offset-x")}),this.vert.set({w:20,h:this.target.canvas.height,zeropos:this.target.get("offset-y")}),this.set({x:this.target.get("x"),y:this.target.get("y"),w:this.target.get("w"),h:this.target.get("h")})},o.prototype.event_map=function(){return[r,{"?target":{"?target":{change:this.onchange}}}]},o.prototype.onchange=function(t,e,n){var r;return n.hasOwnProperty("offset-x")&&this.hori.set("zeropos",n["offset-x"]),n.hasOwnProperty("offset-y")&&this.vert.set("zeropos",n["offset-y"]),r=_.pick(n,["x","y","w","h"]),_.isEmpty(r)||this.set(r),this.draw()},o.spec={type:"ruler-layer",source:"core:layer.RulerLayer",containable:!0,container_type:"layer",description:"Ruler Layer",dependencies:{ruler:e},properties:[n,{target:{type:"string"}}],components:[{type:"ruler",attrs:{direction:"horizontal",margin:[20,0],opacity:.8,x:0,y:0,zeropos:20,strokeStyle:"navy",lineWidth:1}},{type:"ruler",attrs:{direction:"vertical",margin:[20,0],opacity:.8,x:0,y:0,zeropos:20,strokeStyle:"navy",lineWidth:1}}]},o}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(44),n(42),n(24),n(25),n(27)],o=function(t,e,n,r,o,i){"use strict";var a,u,c,h,p,l,f,d,g,y,v,m;return m=function(t,e){return _.contains(t,e)?_.pull(t,e):t.unshift(e),t},y=function(t,e){return _.contains(t,e)?t:[e]},v=function(t,e){return _.contains(t,e)?t:(t.unshift(e),t)},f=function(t){return this.selections=t.origin.shiftKey?v(this.selections,t.target):y(this.selections,t.target),this.setFocus(this.selections[0]),this.draglast_position={x:t.offsetX,y:t.offsetY}},p=function(t){return this.offset={x:t.offsetX-this.draglast_position.x,y:t.offsetY-this.draglast_position.y},this.draw()},l=function(){var t,e,n,r;for(r=this.selections,e=0,n=r.length;n>e;e++)t=r[e],t.move&&t.move({delta:this.offset});return this.offset=null,this.draw()},h=function(t){return this.selections=t.origin.shiftKey?m(this.selections,t.target):y(this.selections,t.target),this.setFocus(this.selections[0]),this.draw()},c=function(t,e,n){var r;return r=_.pick(n,["offset-x","offset-y","x","y"]),_.isEmpty(r)?void 0:this.set(r)},d=function(t,e,n){return n.hasOwnProperty("x")&&(this.canvas.style.left=n.x+"px"),n.hasOwnProperty("y")&&(this.canvas.style.top=n.y+"px"),this.draw()},a={"?target":{"(all)":{click:h,tap:h,dragstart:f,drag:p,dragend:l},"?target":{change:c}},"(self)":{"(self)":{change:d}}},g=function(t,e,n){var r,o,i;return o=t.getContainer(),o.canvas||g(o,e,!0),n?(i=t.get("rotate")||0,r=t.center(),e.translate(r.x,r.y),e.rotate(i*Math.PI/180),e.translate(-r.x,-r.y),e.translate(t.get("x"),t.get("y"))):void 0},u=function(t){function u(){return u.__super__.constructor.apply(this,arguments)}return s(u,t),u.prototype.capture=function(t){var e,n,r,o,i,s,a;if(r=this.canvas.getContext("2d"),r.beginPath(),i={x:t.x-this.get("offset-x")-this.get("x"),y:t.y-this.get("offset-y")-this.get("y")},this.shape(r),this.size()>0)for(o=s=a=this.size()-1;0>=a?0>=s:s>=0;o=0>=a?++s:--s)if(n=this.getAt(o),e=n.capture(i,r))return e;return null},u.prototype.onadded=function(){var t;return this.selections=[],this.target=this.select(this.get("target"))[0],t={"offset-x":this.get("offset-x")||this.target.get("offset-x"),"offset-y":this.get("offset-y")||this.target.get("offset-y"),x:this.get("x")||this.target.get("x"),y:this.get("y")||this.target.get("y"),w:this.target.get("w"),h:this.target.get("h")},this.set(t)},u.prototype._draw=function(){var t,e,n,r,o;if(this.selections){if(this.clearCanvas(),t=this.canvas.getContext("2d"),t.save(),t.translate(this.get("offset-x"),this.get("offset-y")),t.globalAlpha=.4,this.selections.length>0){for(t.save(),this.offset&&t.translate(this.offset.x,this.offset.y),o=this.selections,n=0,r=o.length;r>n;n++)e=o[n],t.save(),g(e,t),e.draw(t),t.restore();t.restore()}return t.globalAlpha=1,this.focus&&this.forEach(function(e){return e.draw(t)}),t.restore()}},u.prototype.buildHandles=function(){var t,e,n,r,o;for(r=this.focus.handles(),o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(this.build({type:t,attrs:{target:"#"+this.focus.get("id")}}));return o},u.prototype.setFocus=function(t){return this.focus!==t&&(this.removeAll(),this.focus=t,this.focus)?(this.buildHandles(),this.draw()):void 0},u.prototype.event_map=function(){return[a,n]},u.spec={type:"selection-layer",source:"core:layer.SelectionLayer",containable:!0,container_type:"layer",description:"Selection Layer",dependencies:{"bound-handle":r,"circle-handle":o,"p2p-handle":i},properties:[e,{target:{type:"string"}}]},u}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(44),n(42),n(10)],o=function(t,e,n,r){"use strict";var o,i,a,u,c;return c=function(t){return this.slide_last_position={x:t.offsetX,y:t.offsetY}},a=function(t){var e,n;return e={x:t.offsetX-this.slide_last_position.x,y:t.offsetY-this.slide_last_position.y},this.slide_target=this.slide_target||this.select(this.get("target"))[0],n={x:this.slide_target.get("offset-x"),y:this.slide_target.get("offset-y")},this.slide_target.set({"offset-x":n.x+e.x,"offset-y":n.y+e.y}),this.slide_handle.move({delta:e}),this.slide_last_position={x:t.offsetX,y:t.offsetY},this.draw()},u=function(){return this.slide_last_position=null,this.slide_handle.set({cx:this.canvas.width/2-this.get("offset-x"),cy:this.canvas.height/2-this.get("offset-y")}),this.draw()},o={"(self)":{"#slide-handle":{dragstart:c,drag:a,dragend:u}}},i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype.onadded=function(){return this.slide_handle=this.select("#slide-handle")[0],this.slide_handle.set({cx:this.canvas.width/2-this.get("offset-x"),cy:this.canvas.height/2-this.get("offset-y")}),this.draw()},i.prototype._draw=function(){var t,e;return this.clearCanvas(),t=this.canvas.getContext("2d"),e={x:this.get("offset-x"),y:this.get("offset-y")},t.translate(e.x,e.y),t.globalAlpha=.5,this.outline_target&&(this.offset&&t.translate(this.offset.x,this.offset.y),this.outline_target.draw(t),this.offset&&t.translate(-this.offset.x,-this.offset.y)),t.globalAlpha=1,this.forEach(function(e){return e.draw(t)}),t.translate(-e.x,-e.y)},i.prototype.event_map=function(){return[o,n]},i.spec={type:"slide-layer",source:"core:layer.SlideLayer",containable:!0,container_type:"layer",description:"Slide Layer",dependencies:{circle:r},properties:[e],components:[{type:"circle",attrs:{id:"slide-handle",cx:100,cy:100,r:20,lineWidth:5,strokeStyle:"red",fillStyle:"black",capturable:!0,draggable:!0}}]},i}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(3),n(44)],o=function(t,e){"use strict";var n;return n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,t),n.prototype.model=function(t){var e,n,r,o,i;if(t.components){for(o=t.components,i=[],n=0,r=o.length;r>n;n++)e=o[n],i.push(this.build(e,this));return i}},n.spec={type:"widget-layer",source:"core:layer.WidgetLayer",containable:!0,container_type:"layer",description:"Widgets Layer",dependencies:{},properties:[e]},n}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4)],o=function(t,e){"use strict";var n,r,o,i,a,u,c,h;return c=-1,a=0,n=1,i=-1,o=0,u=1,h=[[i,c],[o,c],[u,c],[i,a],[u,a],[i,n],[o,n],[u,n]],r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t,e,n,r,o;return t=this.target.bound(),o=Math.round(t.w/2),r=Math.round(t.h/2),e=Math.round(t.x+o),n=Math.round(t.y+r),this.forEach(function(t){var i;return i=t.get("index"),t.set({x:e+h[i][0]*o,y:n+h[i][1]*r})})},n.prototype.onadded=function(){var t,e,n,r;for(this.set("clip",!1),this.target=this.select(this.get("target"))[0],t=n=0,r=h.length;r>n;t=++n)e=h[t],this.build({type:"handle",attrs:{r:8,strokeStyle:"red",lineWidth:2,capturable:!1,fillStyle:"black",index:t,draggable:!0}});return this.align()},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,o;return n=t.target,e={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},r=n.get("index"),o={w:this.target.get("w")+e.x*h[r][0],h:this.target.get("h")+e.y*h[r][1]},h[r][0]===i&&(o.x=this.target.get("x")+e.x),h[r][1]===c&&(o.y=this.target.get("y")+e.y),this.target.set(o),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"bound-handle",source:"core:handle.BoundHandle",containable:!0,description:"Bound Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4)],o=function(t,e){"use strict";var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t,e,n,r;return n=this.target.get("r"),t=this.target.get("cx"),e=this.target.get("cy"),r=this.get("theta")||0,this.handle.set({x:t+Math.round(Math.cos(r)*n),y:e+Math.round(Math.sin(r)*n)})},n.prototype.onadded=function(){return this.set("clip",!1),this.set("theta",0),this.target=this.select(this.get("target"))[0],this.handle=this.build({type:"handle",attrs:{r:8,index:0,strokeStyle:"red",fillStyle:"black",lineWidth:1,draggable:!0}}),this.align()},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,o,i,s,a;return o=t.target,e={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},i=o.get("x")+e.x,s=o.get("y")+e.y,o.set({x:i,y:s}),n=i-this.target.get("cx"),r=s-this.target.get("cy"),this.set({theta:Math.atan2(r,n)}),a=Math.round(Math.sqrt(n*n+r*r)),this.target.set({r:a}),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"circle-handle",source:"core:handle.CircleHandle",containable:!0,description:"Circle Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(7),n(50)],o=function(t,e){"use strict";var n,r;return r=function(t,e,n){var o,i,s;return i=t.getContainer(),i.canvas||r(i,e,!0),n?(s=t.get("rotate")||0,o=t.center(),e.translate(o.x,o.y),e.rotate(s*Math.PI/180),e.translate(-o.x,-o.y),e.translate(t.get("x"),t.get("y"))):void 0},n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,t),n.include(e),n.prototype.center=function(){return{x:this.get("x"),y:this.get("y")}},n.prototype.shape=function(t){var e,n,o;return o=this.getContainer().target,t.save(),r(o,t),e=o.center(),n=o.get("rotate"),t.translate(e.x,e.y),t.rotate(n*Math.PI/180),t.translate(-e.x,-e.y),t.arc(this.get("x"),this.get("y"),this.get("r"),0,2*Math.PI,!1),t.restore()},n.prototype.event_map=function(){return[]},n.spec={type:"handle",source:"core:handle.Handle",containable:!1,description:"Base Handle",dependencies:{},properties:[{x:{type:"number"},y:{type:"number"},r:{type:"number"},index:{type:"string"}}]},n}(t)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4)],o=function(t,e){"use strict";var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t;return t=[[this.target.get("x1"),this.target.get("y1")],[this.target.get("x2"),this.target.get("y2")]],this.forEach(function(e){var n;return n=e.get("index"),e.set({x:t[n][0],y:t[n][1]})})},n.prototype.onadded=function(){var t,e;for(this.set("clip",!1),this.target=this.select(this.get("target"))[0],t=e=0;1>=e;t=++e)this.build({type:"handle",attrs:{r:8,index:t,strokeStyle:"red",fillStyle:"black",lineWidth:2,draggable:!0}});return this.align()},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,o,i,s;switch(n=t.target,e={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},o=n.get("x")+e.x,i=n.get("y")+e.y,n.set({x:o,y:i}),r=n.get("index")){case 0:s={x1:this.target.get("x1")+e.x,y1:this.target.get("y1")+e.y};break;case 1:s={x2:this.target.get("x2")+e.x,y2:this.target.get("y2")+e.y}}return this.target.set(s),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"p2p-handle",source:"core:handle.P2PHandle",containable:!0,description:"Point-to-Point Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(39),n(26),n(4)],o=function(t,e,n){"use strict";var r;return r=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,n),r.prototype.align=function(){var t;return t=this.target.get("path"),this.forEach(function(e){var n;return n=e.get("index"),e.set({x:t[n][0],y:t[n][1]})})},r.prototype.onadded=function(){var t,e,n,r;for(this.set("clip",!1),this.target=this.select(this.get("target"))[0],e=this.target.get("path"),t=n=0,r=e.length-1;r>=0?r>=n:n>=r;t=r>=0?++n:--n)this.build({type:"handle",attrs:{r:8,index:t,strokeStyle:"red",fillStyle:"black",lineWidth:2,draggable:!0}});return this.align()},r.prototype.onchange=function(){return this.align(),this.draw()},r.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},r.prototype.ondrag=function(e){var n,r,o,i,s,a;return r=e.target,n={x:e.offsetX-this.startpos.x,y:e.offsetY-this.startpos.y},i=r.get("x")+n.x,s=r.get("y")+n.y,r.set({x:i,y:s}),o=r.get("index"),a=t.clone(this.target.get("path")),a[o][0]+=n.x,a[o][1]+=n.y,this.target.set("path",a),this.startpos={x:e.offsetX,y:e.offsetY}},r.prototype.ondragend=function(){},r.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},r.spec={type:"path-handle",source:"core:handle.PathHandle",containable:!0,description:"Path Handle",dependencies:{handle:e},properties:[{target:{type:"string"}}]},r}(n)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=[n(26),n(4)],o=function(t,e){"use strict";var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.align=function(){var t,e,n,r,o;return t=this.target.bound(),o=Math.round(t.w/2),r=Math.round(t.h/2),e=Math.round(t.x+t.w/2),n=Math.round(t.y-20),this.handle.set({x:e,y:n})},n.prototype.onadded=function(){return this.set("clip",!1),this.target=this.select(this.get("target"))[0],this.handle=this.build({type:"handle",attrs:{r:8,draggable:!0,strokeStyle:"red",fillStyle:"black",lineWidth:1}}),this.align()},n.prototype.onchange=function(){return this.align(),this.draw()},n.prototype.ondragstart=function(t){return this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondrag=function(t){var e,n,r,o,i,s,a,u;return r=t.target,n={x:t.offsetX-this.startpos.x,y:t.offsetY-this.startpos.y},o=r.get("index"),e=this.target.bound(),i=Math.round(e.x+e.w/2),s=Math.round(e.y+e.h/2),u=Math.atan2(t.offsetY-s,t.offsetX-i),u-=Math.atan2(this.startpos.y-s,this.startpos.x-i),a=this.target.get("rotate")||0,this.target.set({rotate:a+180*u/Math.PI}),this.startpos={x:t.offsetX,y:t.offsetY}},n.prototype.ondragend=function(){},n.prototype.event_map=function(){return{"?target":{"?target":{change:this.onchange}},"(self)":{handle:{dragstart:this.ondragstart,drag:this.ondrag,dragend:this.ondragend}}}},n.spec={type:"rotation-handle",source:"core:handle.RotationHandle",containable:!0,description:"Rotation Handle",dependencies:{handle:t},properties:[{target:{type:"string"}}]},n}(e)}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){var t,e,n,r,o;return n=window.devicePixelRatio,n||(n=(window.matchMedia&&window.matchMedia("(min-resolution: 2dppx), (-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches?2:1)||1),o=Math.round(screen.width*n),r=Math.round(screen.height*n),e=function(t){var e;return o>0||(o=1),r>0||(r=1),e=Math.sqrt(o*o+r*r)/t,e>0?Math.round(e):0},t={version:"@@version",calcDpi:e,listenClickTap:!1,inDblClickWindow:!1,enableTrace:!1,traceArrMax:100,dblClickWindow:400,pixelRatio:void 0,dragDistance:0,angleDeg:!0,showWarnings:!0,Filters:{},isDragging:function(){var t;return t=things.DD,t?t.isDragging:!1},isDragReady:function(){var t;return t=things.DD,t?!!t.node:!1},_parseUA:function(t){var e,n,r,o;return o=t.toLowerCase(),n=/(chrome)[ \/]([\w.]+)/.exec(o)||/(webkit)[ \/]([\w.]+)/.exec(o)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(o)||/(msie) ([\w.]+)/.exec(o)||o.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(o)||[],r=!!t.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),e=!!t.match(/IEMobile/i),{browser:n[1]||"",version:n[2]||"0",mobile:r,ieMobile:e}},UA:void 0},t.UA=t._parseUA(navigator&&navigator.userAgent||""),console.log("UA",t.UA),t}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o,i={}.hasOwnProperty;r=[n(39)],o=function(t){"use strict";var e;return e=function(){function e(){this.componentSpecs={}}return e.prototype.dispose=function(){var t,e,n,r,o;for(t=Object.keys(this.componentSpecs),o=[],n=0,r=t.length;r>n;n++)e=t[n],o.push(this.unregister(e));return o},e.prototype.setRegisterCallback=function(t,e){return this.callback_register="function"==typeof t?t.bind(e):void 0},e.prototype.setUnregisterCallback=function(t,e){return this.callback_unregister="function"==typeof t?t.bind(e):void 0},e.prototype.register=function(e,n){var r,o,i,s,a,u,c,h;if(!this.componentSpecs[e]){if(n.spec.dependencies){c=n.spec.dependencies;for(i in c)r=c[i],this.register(i,r)}if(n.spec.properties instanceof Array){for(s={},h=n.spec.properties,a=0,u=h.length;u>a;a++)o=h[a],t.merge(s,o);n.spec.properties=s}return this.componentSpecs[e]=n,this.callback_register?this.callback_register(n.spec):void 0}},e.prototype.unregister=function(t){var e;return(e=this.componentSpecs[t])?(delete this.componentSpecs[t],this.callback_unregister&&this.callback_unregister(e),e):void 0},e.prototype.forEach=function(t,e){var n,r,o,s;o=this.componentSpecs,s=[];for(n in o)i.call(o,n)&&(r=o[n],s.push(t.call(e,n,r)));return s},e.prototype.list=function(){return Object.keys(this.componentSpecs).map(function(t){return this.componentSpecs[t]},this)},e.prototype.get=function(e){var n;return n=this.componentSpecs[e],n?t.clone(this.componentSpecs[e]):null},e}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(7),n(8)],o=function(t,e){"use strict";var n,r,o,i,s,a,u;return r=function(t,e){return t.substr(1)===e.get("id")},i=function(t,e){var n;return n=e.get("tag"),n?n.indexOf(t.substr(1))>-1:!1},o=function(t,e,n,r){switch(t){case"(all)":return!0;case"(self)":return n===e;case"(root)":return r===e;default:return!1}},s=function(t,e){return t===e.type},n=function(t,e,n,a){switch(t.charAt(0)){case"#":return r(t,e,n,a);case".":return i(t,e,n,a);case"(":return o(t,e,n,a);default:return s(t,e,n,a)}},u=function(t,n,r,o,i,s){return t(n,r,o,i)&&s.push(r),r instanceof e&&r.forEach(function(e){return u(t,n,e,o,i,s)}),s},a=function(t,e,n){var a;return"(root)"===t?[e]:"(self)"===t?[n]:(a=function(){switch(t.charAt(0)){case"#":return r;case".":return i;case"(":return o;default:return s}}(),u(a,t,e,n,e,[]))},{select:a,match:n}}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(39)],o=function(t){"use strict";var e;return e=function(){function e(t,e){this.componentRegistry=t,this.controller=e}return e.prototype.dispose=function(){return this.componentRegistry=null,this.controller=null},e.prototype.build=function(t,e){var n;return n=this.createByModel(t),this.setupDescendant(n,t.components),e&&e.add(n),n},e.prototype.create=function(e,n){var r,o,i,s,a,u;if(i=this.componentRegistry.get(e),!i)throw new Error("module ("+model.type+") is not registered yet.");if(n||(n={}),n.hasOwnProperty("id")||(n.id=t.uniqueId()),o=new i(e).initialize(n,i.spec.properties),o.setController(this.controller),o.init&&o.init(),i.spec.components)for(u=i.spec.components,s=0,a=u.length;a>s;s++)r=u[s],this.build(r,o);return o},e.prototype.createByModel=function(t){var e,n,r;if(t.dependencies){r=t.dependencies;for(n in r)e=r[n],this.componentRegistry.register(n,e)}return this.create(t.type,t.attrs)},e.prototype.setupDescendant=function(t,e){var n,r,o,i,s;if(r=this.componentRegistry.get(t.type),o=r.spec,e)for(i=0,s=e.length;s>i;i++)n=e[i],this.build(n,t);return t},e}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o,i={}.hasOwnProperty;r=[n(39),n(61),n(32)],o=function(t,e,n){"use strict";var r;return r=function(){function r(t){this.eventMaps=[],this.setRoot(t)}return r.prototype.setRoot=function(t){return this.root=t},r.prototype.stop=function(){var t,e,n,r,o;for(r=this.eventMaps,o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(t.eventPump.stop());return o},r.prototype.add=function(t,r,o){var s,a,u,c,h,p,l,f,d,g,y;if(this.root){if(!(r instanceof Array))return void this.add(t,[r],o);for(y=[],d=0,g=r.length;g>d;d++)a=r[d],y.push(function(){var r;r=[];for(c in a)if(i.call(a,c)){if(u=a[c],0===c.indexOf("?")){if(f=c.substr(1),l=t.get(f),!l){console.log("EventEngine#add","variable "+c+" is not evaluated on listener");continue}c=l}p=n.select(c,this.root,t),r.push(function(){var n,r,i;for(i=[],n=0,r=p.length;r>n;n++)h=p[n],s=new e(h),s.on(t,u),s.start(o),i.push(this.eventMaps.push({eventPump:s,listener:t,handlerMap:a,target:h}));return i}.call(this))}return r}.call(this));return y}},r.prototype.remove=function(e,n){var r,o,i,s,a,u;for(i=t.clone(this.eventMaps),u=[],r=s=0,a=i.length;a>s;r=++s)o=i[r],o.listener!==e||n&&o.handlerMap!==n?u.push(void 0):(this.eventMaps.splice(r,1),u.push(o.eventPump.dispose()));return u},r.prototype.clear=function(){var e,n,r,o;for(n=t.clone(this.eventMaps),r=0,o=n.length;o>r;r++)e=n[r],e.eventPump.dispose();return this.eventMaps=[]},r.prototype.dispose=function(){return this.stop(),this.clear()},r}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t=function(){function t(t){this.binder=t,this.exports={}}return t.prototype.dispose=function(){var t,e,n,r,o;for(e=Object.keys(this.exports),o=[],n=0,r=e.length;r>n;n++)t=e[n],o.push(this.remove(t));return o},t.prototype["import"]=function(t,e,n){var r,o,i;if(e){i={};for(r in e)o=e[r],i[r]=o instanceof Function?o.bind(n||this.binder):o;return this.exports[t]=i}},t.prototype.remove=function(t){return delete this.exports[t]},t.prototype.require=function(t){return this.exports[t]},t}()}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o;r=[n(62),n(63)],o=function(t,e){"use strict";var n,r,o,i,s,a,u;return o=function(n){var r;return r=this.stage.point(n),this.captured=this.stage.capture(r),this.click_target=this.captured,t.draggable=!0,e.mousedown(this.captured,n,r),n.preventDefault?n.preventDefault():void 0},u=function(n){var r,o,i;return o=this.stage.point(n),this.captured=this.stage.capture(o),r=!1,this.listening_dbl_click?(r=!0,this.listening_dbl_click=!1):this.listening_dbl_click=!0,i=this,setTimeout(function(){return i.listening_dbl_click=!1},500),this.captured&&!t.dragging&&(e.mouseup(this.captured,n,o),this.click_target&&this.captured===this.click_target&&(e.click(this.captured,n,o),r&&(e.doubleclick(this.captured,n,o),this.listening_dbl_click=!1))),this.click_target=null,n.preventDefault?n.preventDefault():void 0},a=function(n){var r,o,i,s,a;if("undefined"==typeof n.webkitMovementX&&"undefined"==typeof n.webkitMovementY||0!==n.webkitMovementY||0!==n.webkitMovementX){if(a=this.stage.point(n),o=this.captured,this.captured=this.stage.capture(a),!t.dragging&&(this.captured&&e.mousemove(this.captured,n,a),this.captured!==o)){if(i=[this.captured],this.captured)for(;r=(r||this.captured).getContainer();)i.unshift(r);if(s=[o],o)for(;r=(r||o).getContainer();)s.unshift(r);for(;s[0]===i[0];)s.shift(),i.shift();for(;r=s.pop();)e.mouseout(r,n,a);for(;r=i.shift();)e.mouseover(r,n,a)}return t.draggable&&this.captured&&t.drag(this.captured,n,a),n.preventDefault?n.preventDefault():void 0}},s=function(t){var n,r,o;if(!this.dragging){if(this.captured){for(o=this.stage.point(t),n=this.captured,r=[this.captured];n=n.getContainer();)r.unshift(n);for(;n=r.pop();)e.mouseout(n,t,o)}return this.captured=null}},i=function(){},r=function(t){var n;return t.preventDefault(),n=this.stage.point(t),this.captured=this.stage.capture(n),e.contextmenu(this.captured,t,n)},n=function(){function t(t){this.stage=t,this.onmousemove=a.bind(this),this.onmouseleave=s.bind(this),this.onmouseenter=i.bind(this),this.onmouseup=u.bind(this),this.onmousedown=o.bind(this),this.oncontextmenu=r.bind(this),this.stage.html_container.addEventListener("mousemove",this.onmousemove),this.stage.html_container.addEventListener("mouseleave",this.onmouseleave),this.stage.html_container.addEventListener("mouseenter",this.onmouseenter),this.stage.html_container.addEventListener("mouseup",this.onmouseup),this.stage.html_container.addEventListener("mousedown",this.onmousedown),this.stage.html_container.addEventListener("contextmenu",this.oncontextmenu)}return t.prototype.dispose=function(){return this.stage.html_container.removeEventListener("mousemove",this.onmousemove),this.stage.html_container.removeEventListener("mouseleave",this.onmouseleave),this.stage.html_container.removeEventListener("mouseenter",this.onmouseenter),this.stage.html_container.removeEventListener("mouseup",this.onmouseup),this.stage.html_container.removeEventListener("mousedown",this.onmousedown),this.stage.html_container.removeEventListener("contextmenu",this.oncontextmenu)},t}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(63),n(62)],o=function(t,e){"use strict";var n,r,o,i;return i=function(e){var n,r,o;return n=this.stage.point(e),o=this.stage.capture(n),this.tap_target=o,r=this,this.longtouch_triggered=!1,this.longtouch_timer=setTimeout(function(){return r.longtouch_timer=null,o&&t.longtouch(o,e,n),r.longtouch_triggered=!0},500),t.touchstart(o,e,n),e.preventDefault?e.preventDefault():void 0},r=function(n){var r,o,i,s;return o=this.stage.point(n),s=this.stage.capture(o),this.longtouch_timer&&(clearTimeout(this.longtouch_timer),this.longtouch_timer=null),r=!1,this.listening_dbl_click?(r=!0,this.listening_dbl_click=!1):this.listening_dbl_click=!0,i=this,setTimeout(function(){return i.listening_dbl_click=!1},500),s&&!e.dragging&&(t.touchend(s,n,o),this.tap_target&&s===this.tap_target&&(t.tap(s,n,o),r&&(t.doubletap(s,n,o),this.listening_dbl_click=!1))),this.tap_target=null,n.preventDefault?n.preventDefault():void 0},o=function(n){var r,o;if(r=this.stage.point(n),this.longtouch_timer&&e.dragging)clearTimeout(this.longtouch_timer),this.longtouch_timer=null;else if(this.longtouch_triggered)return void(n.preventDefault&&n.preventDefault());
return o=this.stage.capture(r),!e.dragging&&o&&(t.touchmove(o,n,r),n.preventDefault&&n.preventDefault()),e.drag(o,n,r),n.preventDefault?n.preventDefault():void 0},n=function(){function t(t){this.stage=t,this.ontouchstart=i.bind(this),this.ontouchmove=o.bind(this),this.ontouchend=r.bind(this),this.stage.html_container.addEventListener("touchstart",this.ontouchstart),this.stage.html_container.addEventListener("touchmove",this.ontouchmove),this.stage.html_container.addEventListener("touchend",this.ontouchend)}return t.prototype.dispose=function(){return this.stage.html_container.removeEventListener("touchstart",this.ontouchstart),this.stage.html_container.removeEventListener("touchmove",this.ontouchmove),this.stage.html_container.removeEventListener("touchend",this.ontouchend)},t}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n,r=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};e=[],n=function(){"use strict";var t,e;return e=["extended","included"],t=function(){function t(){}return t.extend=function(t){var n,o,i;for(n in t)o=t[n],r.call(e,n)<0&&(console.log(n,o),this[n]=o);return null!=(i=t.extended)&&i.apply(this),this},t.include=function(t){var n,o,i;for(n in t)o=t[n],r.call(e,n)<0&&(this.prototype[n]=o);return null!=(i=t.included)&&i.apply(this),this},t}()}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o;r=[n(60)],o=function(t){"use strict";return t}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(65)],o=function(t){"use strict";var e;return e=function(){function e(){this.reset()}return e.prototype.dispose=function(){return this.reset()},e.prototype.execute=function(e){return!e instanceof t?void 0:(e.execute(),this.exq.push(e),this.uxq=[])},e.prototype.undo=function(){var t;return t=this.exq.pop(),t?(t.unexecute(),this.uxq.push(t)):void 0},e.prototype.redo=function(){var t;return t=this.uxq.pop(),t?(t.execute(),this.exq.push(t)):void 0},e.prototype.undoable=function(){return this.exq.length>0},e.prototype.redoable=function(){return this.uxq.length>0},e.prototype.reset=function(){return this.exq=[],this.uxq=[]},e}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(66)],o=function(t){"use strict";var e,n,r,o;return e=function(t,e){var n;return e.event_map&&(n=e.event_map(),this.eventEngine.add(e,n,e)),e.onadded&&e.onadded(t),e.draw()},o=function(t,e){return e.onremoved&&e.onremoved(t),this.eventEngine.remove(e)},r=function(e){return t.show({x:e.origin.pageX,y:e.origin.pageY})},n=function(t,e,n){return console.log("TODO","think about html container on stage width/height change",n),n.hasOwnProperty("w")&&(this.stage.html_container.style.width=n.w+"px"),n.hasOwnProperty("h")?this.stage.html_container.style.height=n.h+"px":void 0},[t,{"(root)":{"(root)":{change:n},"(all)":{add:e,remove:o,contextmenu:r,longtouch:r}}}]}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n;return n=function(){return this.draw()},t=function(t,e,n){return n.hasOwnProperty("x")&&(this.canvas.style.left=n.x+"px"),n.hasOwnProperty("y")&&(this.canvas.style.top=n.y+"px"),n.hasOwnProperty("w")&&this.canvas.setAttribute("width",n.w),n.hasOwnProperty("h")&&this.canvas.setAttribute("height",n.h),this.draw()},e=function(t,e,n){var r,o,i;if(this.get("resizable")!==!1)return r={},o=this.get("x")||0,i=this.get("y")||0,n.hasOwnProperty("w")&&(r.w=n.w-o),n.hasOwnProperty("h")&&(r.h=n.h-i),this.set(r)},{"(root)":{"(root)":{change:e}},"(self)":{"(all)":{added:n,removed:n,change:n},"(self)":{change:t}}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o;r=[n(39),n(45)],o=function(t,e){"use strict";return t.merge({},e,{alpha:{type:"number","default":100}})}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(39),n(45)],o=function(t,e){"use strict";return t.merge({},e,{alpha:{type:"number","default":100},"offset-x":{type:"number","default":0},"offset-y":{type:"number","default":0},resizable:{type:"boolean"}})}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={x:{type:"number","default":0},y:{type:"number","default":0},w:{type:"number"},h:{type:"number"},rotate:{type:"number","default":0}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={lineWidth:{type:"number"},fillStyle:{type:"string"},strokeStyle:{type:"string"},alpha:{type:"number"}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={dockType:function(){},dockPoints:function(){var t,e,n,r;return n=this.get("x"),r=this.get("y"),e=this.get("w"),t=this.get("h"),[[n,r],[n+e,r],[n,r+t],[n+e,r+t]]}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={center:function(){return{x:this.get("x")+this.get("w")/2,y:this.get("y")+this.get("h")/2}},shape:function(t){return t.rect(this.get("x"),this.get("y"),this.get("w"),this.get("h"))},draw:function(t){var e,n;return t?(t.beginPath(),n=this.get("rotate")||0,e=this.center(),t.save(),t.translate(e.x,e.y),t.rotate(n*Math.PI/180),t.translate(-e.x,-e.y),this.shape(t),this.get("fillStyle")&&(t.fillStyle=this.get("fillStyle"),t.fill()),this.get("strokeStyle")&&(t.lineWidth=this.get("lineWidth"),t.strokeStyle=this.get("strokeStyle"),t.stroke()),this.get("clip")&&t.clip(),t.translate(this.get("x"),this.get("y")),this.forEach(function(e){return e.draw(t)}),t.restore()):this.getContainer().draw()},capture:function(t,e){var n,r,o,i,s,a,u,c;if(e.beginPath(),r=this.center(),a=(this.get("rotate")||0)*Math.PI/180,e.save(),e.translate(r.x,r.y),e.rotate(a),e.translate(-r.x,-r.y),this.shape(e),e.lineWidth=this.get("lineWidth"),n=null,s=e.isPointInPath(t.x,t.y)||!!this.get("strokeStyle")&&e.isPointInStroke(t.x,t.y),(!this.get("clip")||s)&&this.size()>0)for(e.translate(this.get("x"),this.get("y")),i=u=c=this.size()-1;(0>=c?0>=u:u>=0)&&(o=this.getAt(i),!(n=o.capture(t,e)));i=0>=c?++u:--u);return e.restore(),n?n:this.get("capturable")===!1?null:s?this:null}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={objectify:function(){var t,e;return"function"==typeof this.forEach&&(t=[],this.forEach(function(e){return t.push(e.objectify())})),e={type:this.type,attrs:this.attrs},t&&(e.components=t),e},serialize:function(){return JSON.stringify(this.objectify())}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={bound:function(){return{x:this.get("x"),y:this.get("y"),w:this.get("w"),h:this.get("h")}},center:function(){var t;return t=this.bound(),{x:t.x+t.w/2,y:t.y+t.h/2}},shape:function(){},capture_shape:function(t){return this.shape(t)},draw:function(t){var e,n;return t?(t.beginPath(),n=this.get("rotate")||0,e=this.center(),t.save(),t.translate(e.x,e.y),t.rotate(n*Math.PI/180),t.translate(-e.x,-e.y),this.shape(t),this.get("fillStyle")&&(t.fillStyle=this.get("fillStyle"),t.fill()),this.get("strokeStyle")&&(t.lineWidth=this.get("lineWidth"),t.strokeStyle=this.get("strokeStyle"),t.stroke()),t.restore()):this.getContainer().draw()},capture:function(t,e){var n,r,o;return e.beginPath(),o=this.get("rotate")||0,n=this.center(),e.save(),e.translate(n.x,n.y),e.rotate(o*Math.PI/180),e.translate(-n.x,-n.y),this.capture_shape(e),this.get("strokeStyle")&&(e.lineWidth=this.get("lineWidth")),r=!!this.get("strokeStyle")&&e.isPointInStroke(t.x,t.y)||!!this.get("fillStyle")&&e.isPointInPath(t.x,t.y),e.restore(),r?this:null}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o,i={}.hasOwnProperty;r=[n(39)],o=function(t){"use strict";var e;return e={silentSet:function(e,n){var r,o,s,a;if(!e)return this;if(arguments.length>1&&"string"==typeof arguments[0])return o={},o[e]=n,this.silentSet(o);this.attrs||(this.attrs={}),o=e,r={},s=t.clone(this.attrs),t.assign(this.attrs,o),a=this.attrs;for(e in a)i.call(a,e)&&(n=a[e],n!==s[e]?r[e]=n:delete s[e]);return this},set:function(e,n){var r,o,s,a;if(!e)return this;if(arguments.length>1&&"string"==typeof arguments[0])return o={},o[e]=n,this.set(o);this.attrs||(this.attrs={}),o=e,r={},s=t.clone(this.attrs),t.assign(this.attrs,o),a=this.attrs;for(e in a)i.call(a,e)&&(n=a[e],n!==s[e]?r[e]=n:delete s[e]);return 0!==Object.keys(r).length&&this.trigger("change",this,s,r),this},get:function(t){var e;if(this.attrs&&this.attrs.hasOwnProperty(t))return this.attrs[t];if(this.property_spec)return e=this.property_spec[t],e?e["default"]:void 0},getAll:function(){return this.attrs?t.clone(this.attrs):{}}}}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={initialize:function(t,e){return this.attrs=t,this.property_spec=e,this},dispose:function(){}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o;r=[n(39),n(64)],o=function(t,e){"use strict";var n,r,o,i,s,a,u,c;n={on:function(t,e,n){var r;return i(this,"on",t,[e,n])&&e?(this._listeners||(this._listeners={}),r=this._listeners[t]||(this._listeners[t]=[]),r.push({callback:e,context:n,ctx:n||this}),this):this},once:function(e,n,r){var o,s;return i(this,"once",e,[n,r])&&n?(s=this,o=t.once(function(){return s.off(e,o),n.apply(this,arguments)}),o._callback=n,this.on(e,o,r)):this},off:function(t,e,n){var r,o,s,a,u,c,h,p,l,f;if(!this._listeners||!i(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._listeners=void 0,this;for(u=t?[t]:Object.keys(this._listeners),s=h=0,l=u.length;l>h;s=++h)if(t=u[s],o=this._listeners[t]){if(this._listeners[t]=c=[],e||n)for(a=p=0,f=o.length;f>p;a=++p)r=o[a],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&c.push(r);c.length||delete this._listeners[t]}return this},delegate_on:function(t){return this._delegators||(this._delegators=new e.List),this._delegators.append(t),this},delegate_off:function(t){return this._delegators?(this._delegators.remove(t),this):this},delegate:function(){var t,e,n;return this._delegators&&this._delegators.size()>0&&r(this._delegators,arguments),this._listeners?(t=arguments[arguments.length-1],t.deliverer=this,e=this._listeners[t.name],n=this._listeners.all,e&&c(e,arguments),n&&c(n,arguments),this):this},trigger:function(t){var e,n,o;return e=[].slice.call(arguments,1),e.push({origin:this,name:t,deliverer:this}),this._delegators&&this._delegators.size()>0&&r(this._delegators,e),this._listeners&&i(this,"trigger",t,e)?(n=this._listeners[t],o=this._listeners.all,n&&c(n,e),o&&c(o,e),this):this},stopListening:function(e,n,r){var o,i,s;if(i=this._listeningTo,!i)return this;s=!n&&!r,r||"object"!=typeof n||(r=this),e&&((i={})[e._listenId]=e);for(o in i)e=i[o],e.off(n,r,this),(s||t.isEmpty(e._events))&&delete this._listeningTo[o];return this}},o=/\s+/,i=function(t,e,n,r){var i,s,a,u,c;if(!n)return!0;if("object"==typeof n){for(i in n)a=n[i],t[e].apply(t,[i,a].concat(r));return!1}if(o.test(n)){for(s=n.split(o),u=0,c=s.length;c>u;u++)a=s[u],t[e].apply(t,[a].concat(r));return!1}return!0},c=function(t,e){var n,r,o,i;for(i=[],r=0,o=t.length;o>r;r++)n=t[r],i.push(n.callback.apply(n.ctx,e));return i},r=function(t,e){return t.forEach(function(t){return n.delegate.apply(t,e)})},a={listenTo:"on",listenToOnce:"once"};for(u in a)s=a[u],n[u]=function(e,n,r){var o,i;return i=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=t.uniqueId("l")),i[o]=e,r||"object"!=typeof n||(r=this),e[s](n,r,this),this};return n}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n,r;return t=function(t,e,n,r){return t.trigger("add",e,n,r)},e=function(t,e,n,r){return t.trigger("added",e,n,r)},n=function(t,e,n){return t.trigger("remove",e,n)},r=function(t,e,n){return t.trigger("removed",e,n)},{add:t,added:e,remove:n,removed:r}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={cx:{type:"number","default":0},cy:{type:"number","default":0},r:{type:"number","default":100}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={path:{type:"array"}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={font:{type:"string","default":"normal 10px verdana"}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t={x1:{type:"number","default":0},y1:{type:"number","default":0},x2:{type:"number","default":100},y2:{type:"number","default":100}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t){var e,n;e=[],n=function(){"use strict";var t;return t=function(t,e,n){var r,o,i,s,a,u,c;if(e>2)return t;if("number"==typeof e||(e=0),"boolean"==typeof n||(n=!1),a=!1,c=function(t){var e,n,r,o;for(n="",e=r=0,o=t-1;o>=0?o>=r:r>=o;e=o>=0?++r:--r)return n+="  "},u="","undefined"==typeof t)u+="undefined";else if("boolean"==typeof t||"number"==typeof t)u+=t.toString();else if("string"==typeof t)u+='"'+t+'"';else if(null===t)u+="null";else if(t instanceof Array)if(t.length>0){n&&(a=!0),r="";for(i in t)o=t[i],r+=pp(o,e+1)+",\n"+c(e+1);r=r.replace(/,\n\s*$/,"").replace(/^\s*/,""),u+="[ "+r+"\n"+c(e)+"]"}else u+="[]";else if("object"==typeof t)if(Object.keys(t).length>0){n&&(a=!0),r="";for(s in t)r+=c(e+1)+s.toString()+": "+pp(t[s],e+2,!0)+",\n";r=r.replace(/,\n\s*$/,"").replace(/^\s*/,""),u+="{ "+r+"\n"+c(e)+"}"}else u+="{}";else u+=t.toString();return(a?"\n"+c(e):"")+u}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(e){e.exports=t},function(t,e,n){var r,o,i={}.hasOwnProperty;r=[n(39),n(32)],o=function(t,e){"use strict";var n,r,o;return r=function(t,n,r,o,s){var a,u,c,h,p;p=[];for(h in r)i.call(r,h)&&(a=r[h],e.match(h,o.origin,n,t)&&p.push(function(){var t;t=[];for(u in a)i.call(a,u)&&(c=a[u],u===o.name&&(o.listener=n,t.push(c.apply(this,s))));return t}.call(this)));return p},o=function(){var t,e,n,o,i,s,a,u;for(t=arguments,e=t[t.length-1],n=this.eventPump,a=n.listeners,u=[],i=0,s=a.length;s>i;i++)o=a[i],u.push(r.call(this.context,n.deliverer,o.listener,o.clonedHandlers,e,t));return u},n=function(){function t(t){this.setDeliverer(t),this.listeners=[]}return t.prototype.setDeliverer=function(t){return this.deliverer=t},t.prototype.start=function(t){return this.deliverer.on("all",o,{context:t||null,eventPump:this})},t.prototype.stop=function(){return this.deliverer.off("all",o)},t.prototype.on=function(t,e){var n,r,o,i,s,a,u,c;for(n=_.clone(e),i=Object.keys(n),u=0,c=i.length;c>u;u++)o=i[u],0===o.indexOf("?")&&(r=n[o],a=o.substr(1),s=t.get(a),delete n[o],s?n[s]=r:console.log("EventPump#on","variable "+o+" is not evaluated on listener"));return this.listeners.push({listener:t,handlers:e,clonedHandlers:n})},t.prototype.off=function(t,e){var n,r,o,i,s,a;for(s=this.listeners,a=[],n=o=0,i=s.length;i>o;n=++o)r=s[n],a.push(r.listener!==t||e&&r.handlers!==e?void 0:this.listeners.splice(n,1));return a},t.prototype.clear=function(){return this.listeners=[]},t.prototype.dispose=function(){return this.stop(),this.clear()},t}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(63)],o=function(t){var e,n,r;return r=function(){},n=function(n){var r,o;return e.dragging=!1,o=e.target,o&&(r=o.getStage().point(n),t.dragend(e.target,n,r)),delete e.target,e.cleanup()},e={draggable:!1,dragging:!1,target:null,drag_end_target:null,start_point:null,last_point:null,cutoff:4,cleanup:function(){return this.target=null,this.drag_end_target=null,this.start_point=null,this.last_point=null,this.dragging=!1,this.draggable=!1},drag:function(e,n,r){var o;if(this.start_point||(this.start_point=r),!this.dragging&&e.get("draggable")){if(void 0!==n.touches&&(o=Math.max(Math.abs(r.x-this.start_point.x),Math.abs(r.y-this.start_point.y)),o<this.cutoff))return;this.dragging=!0,this.target=e,t.dragstart(e,n,this.start_point)}return this.dragging?(this.last_point=r,t.drag(this.target,n,r)):void 0}},document.addEventListener("mouseup",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("mouseup",n,!1),document.addEventListener("touchend",n,!1),e}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t,e,n){var r,o;r=[n(39)],o=function(t){"use strict";var e,n,r;return r=function(t,e,n,r){var o,i;return r||(i=t.getStage(),r=i.point(n)),o={origin:n,type:e,target:t,offsetX:r.x,offsetY:r.y},t.trigger(o.type,o)},e=function(t){return function(e,n,o){return r(e,t,n,o)}},n=["mousemove","mousedown","mouseup","click","doubleclick","contextmenu","mouseover","mouseout","dragstart","drag","dragend","touchstart","touchmove","touchend","longtouch","tap","doubletap"],t.reduce(n,function(t,n){return t[n]=e(n),t},{})}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n,r={}.hasOwnProperty;e=[],n=function(){"use strict";var t,e,n,o,i;return o={insertAt:function(t,e){return this.__collection__?(t=this.__collection__.indexOf(e),-1===this.__collection__.indexOf(e)&&this.__collection__.splice(t,0,e),this):this},append:function(t){return this.__collection__||(this.__collection__=[]),-1===this.__collection__.indexOf(t)&&this.__collection__.push(t),this},prepend:function(t){return this.__collection__||(this.__collection__=[]),-1===this.__collection__.indexOf(t)&&this.__collection__.unshift(t),this},remove:function(t){var e;return this.__collection__?(e=this.__collection__.indexOf(t),e>-1&&this.__collection__.splice(e,1),this):this},getAt:function(t){return this.__collection__?this.__collection__[t]:void 0},forEach:function(t,e){return this.__collection__?this.__collection__.forEach(t,e):this},indexOf:function(t){return(this.__collection__||[]).indexOf(t)},size:function(){return(this.__collection__||[]).length},clear:function(){return this.__collection__=[]},moveForward:function(t){var e;return e=this.indexOf(t),-1!==e&&0!==e?(this.__collection__[e]=this.__collection__[e-1],this.__collection__[e-1]=t):void 0},moveBackward:function(t){var e;return e=this.indexOf(t),-1!==e&&e!==this.size()-1?(this.__collection__[e]=this.__collection__[e+1],this.__collection__[e+1]=t):void 0},moveToHead:function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&0!==n?(e=this.__collection__.splice(0,n),r=this.__collection__.splice(1),this.__collection__=this.__collection__.concat(e,r)):void 0},moveToTail:function(t){var e,n,r;return n=this.indexOf(t),-1!==n&&n!==this.size()-1?(e=this.__collection__.splice(0,n),r=this.__collection__.splice(1),this.__collection__=e.concat(r,this.__collection__)):void 0}},i={push:function(){throw new Error("Not Implemented Yet")},pop:function(){throw new Error("Not Implemented Yet")}},e=function(){},e.prototype=o,n=function(){},n.prototype=i,t={List:e,Stack:n,withList:function(){var t,e,n;n=[];for(t in o)r.call(o,t)&&(e=o[t],n.push(this[t]=e));return n},withStack:function(){var t,e,n;n=[];for(t in i)r.call(i,t)&&(e=i[t],n.push(this[t]=e));return n}}}.apply(null,e),!(void 0!==n&&(t.exports=n))},function(t,e,n){var r,o;r=[n(39)],o=function(t){"use strict";var e;return e=function(){function e(e){this.params=t.clone(e)}return e.prototype.execute=function(){},e.prototype.unexecute=function(){},e}()}.apply(null,r),!(void 0!==o&&(t.exports=o))},function(t){var e,n;e=[],n=function(){"use strict";var t,e,n,r,o,i;return i='<ul id="context-menu" class="things-context-menu"> <li><a href="http://cooking.hatiolab.com/">Cooking</a></li> <li><a href="http://www.naver.com">Naver</a></li> </ul>',t=document.createElement("div"),t.style.position="absolute",t.style.display="inline-block",t.style.zIndex=1e3,document.body.appendChild(t),t.innerHTML=i,e=document.getElementById("context-menu"),n=function(){return document.removeEventListener("click",n),document.removeEventListener("touchstart",n),setTimeout(r,100)},o=function(r){return t.style.top=r.y+"px",t.style.left=r.x+"px",e.style.display="block",document.addEventListener("click",n),document.addEventListener("touchstart",n)},r=function(){return e.style.display="none"},{show:o,hide:r}}.apply(null,e),!(void 0!==n&&(t.exports=n))}])});